{"ast":null,"code":"import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useRef,useEffect}from\"react\";import Container from\"@material-ui/core/Container\";import Grid from\"@material-ui/core/Grid\";import ExitToAppIcon from\"@material-ui/icons/ExitToApp\";import Typography from\"@material-ui/core/Typography\";import IconButton from\"@material-ui/core/IconButton\";import LockOutlinedIcon from\"@material-ui/icons/LockOutlined\";import CreateIcon from\"@material-ui/icons/Create\";import ExpandMoreIcon from\"@material-ui/icons/ExpandMore\";import ExpandLessIcon from'@material-ui/icons/ExpandLess';import Avatar from\"@material-ui/core/Avatar\";import Button from\"@material-ui/core/Button\";import Rating from\"@material-ui/lab/Rating\";import Collapse from\"@material-ui/core/Collapse\";import TextField from\"@material-ui/core/TextField\";import{makeStyles}from\"@material-ui/core/styles\";import{NavLink,useHistory}from\"react-router-dom\";import{useMutation}from\"@apollo/react-hooks\";import{UPDATE_USER}from\"src/Services/GQL/UPDATE_USER\";import{PROFILE_DATA}from\"src/Services/GQL/PROFILE_DATA\";import{findEmpty}from\"src/Services/functions\";import{useXsSize}from\"src/Hooks/useXsSize\";import{useAverageRating}from\"src/Hooks/useAverageRating\";import{UserContext}from\"src/userContext\";import DropzoneSignup from\"src/Molecules/DropzoneSignup\";export default function ProfileTopBox(_ref){var errorQuery=_ref.errorQuery,showRatings=_ref.showRatings;var classes=useStyles();var history=useHistory();var _useXsSize=useXsSize(),md_size_memo=_useXsSize.md_size_memo;var _useContext=useContext(UserContext),context=_useContext.context;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),expanded=_useState2[0],setExpanded=_useState2[1];var _useState3=useState({picture:context.picture}),_useState4=_slicedToArray(_useState3,2),formValue=_useState4[0],setFormValue=_useState4[1];var _useMutation=useMutation(UPDATE_USER),_useMutation2=_slicedToArray(_useMutation,2),updateUser=_useMutation2[0],_useMutation2$=_useMutation2[1],loading=_useMutation2$.loading,error=_useMutation2$.error,data=_useMutation2$.data;var inputName=useRef(null);var inputEmail=useRef(null);var inputDescription=useRef(null);var _useAverageRating=useAverageRating(showRatings),averageRating=_useAverageRating.averageRating;var _ref2=data?data.updateUser:{dataOut:undefined},dataOut=_ref2.dataOut;var _ref3=data?data.updateUser:{errorOut:undefined},errorOut=_ref3.errorOut;useEffect(function(){if(dataOut&&dataOut.success){context.getLoggedInUser();}},[dataOut]);var onSubmitHandler=function onSubmitHandler(e){e.preventDefault();console.log(\"Updating: \",inputName.current.value,inputEmail.current.value,inputDescription.current.value);var load={_id:context._id,name:inputName.current.value,email:inputEmail.current.value,description:inputDescription.current.value,picture:formValue?formValue.picture:context.picture};var empty=findEmpty(load);empty=empty.map(function(item){return\"\".concat(item,\" is Empty\");});if(load.password!=load.password2)empty.push(\"Not matching passwords\");console.log(\"Empty ones: \",empty);if(empty.length==0){updateUser({variables:load,refetchQueries:function refetchQueries(){return[{query:PROFILE_DATA,variables:{host_id:context._id}}];}});setExpanded(!expanded);}else{// setFEerrors(empty);\n}};return React.createElement(\"div\",{className:classes.mainWrap},React.createElement(Container,{maxWidth:\"sm\",className:classes.mainContainer},React.createElement(Grid,{container:true,justify:\"center\",direction:\"column\",alignItems:\"center\",style:{// backgroundImage: `url(${context.picture})`,\nbackground:md_size_memo?null:\"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(123,81,117,1) 100%)\"},className:classes.mainGridContainer},React.createElement(Grid,{item:true,style:{paddingTop:md_size_memo?80:40},className:classes.profileTopBox},expanded?null:React.createElement(React.Fragment,null,React.createElement(Grid,{container:true,direction:\"row\",justify:\"center\"},React.createElement(Grid,{item:true},React.createElement(Grid,{container:true,justify:\"center\"},React.createElement(Grid,{item:true},React.createElement(Avatar,{className:classes.avatar,src:context.picture},React.createElement(LockOutlinedIcon,null)))))),React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",style:{width:\"100%\"}},React.createElement(Grid,{item:true,xs:12},React.createElement(Typography,{component:\"h1\",variant:\"h5\",className:classes.centerText},context.name)),React.createElement(Grid,{item:true,xs:12},React.createElement(Typography,{variant:\"body1\",className:classes.centerText},context.email)),React.createElement(Grid,{item:true,xs:12},React.createElement(Typography,{variant:\"body1\",className:classes.centerText},React.createElement(Rating,{name:\"simple-controlled\",readOnly:true,value:averageRating}))),React.createElement(Grid,{item:true,xs:12},React.createElement(Typography,{variant:\"body1\",className:classes.oneLineDescription},context.description),React.createElement(Typography,{variant:\"body1\",className:classes.oneLineDescription},errorQuery&&React.createElement(\"h1\",null,\"ERROR while loading profile data\"))))),React.createElement(Collapse,{in:expanded,timeout:\"auto\",unmountOnExit:true},React.createElement(Grid,{item:true,className:classes.descWrap},React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",direction:\"column\",className:classes.gridDropzone},React.createElement(Grid,{item:true},React.createElement(DropzoneSignup,{setFormValue:setFormValue,formValue:formValue}))),React.createElement(TextField,{id:\"outlined-basic\",label:\"Name\",variant:\"filled\",defaultValue:context.name,inputRef:inputName,className:classes.textFieldDesc,multiline:true,rows:\"1\"}),React.createElement(TextField,{id:\"outlined-basic\",label:\"Email\",variant:\"filled\",disabled:true,defaultValue:context.email,inputRef:inputEmail,className:classes.textFieldDesc,multiline:true,rows:\"1\"}),React.createElement(TextField,{id:\"outlined-basic\",label:\"Description\",variant:\"filled\",defaultValue:context.description,inputRef:inputDescription,className:classes.textFieldDesc,multiline:true,rows:\"4\"}),React.createElement(Button,{type:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.saveButton,onClick:function onClick(e){onSubmitHandler(e);}},\"SAVE\"))),React.createElement(Grid,{item:true,xs:12},React.createElement(Grid,{container:true,className:classes.buttonContainer},React.createElement(Grid,{item:true,xs:6},React.createElement(Grid,{container:true,justify:\"center\"},React.createElement(Grid,{item:true},React.createElement(Button,{className:classes.outButton,onClick:function onClick(){history.push(\"/signout\");}},\"SIGN OUT\")))),React.createElement(Grid,{item:true,xs:6},React.createElement(Grid,{container:true,justify:\"center\"},React.createElement(Grid,{item:true,onClick:function onClick(){setExpanded(!expanded);}},React.createElement(Button,{className:classes.settingsButton},React.createElement(CreateIcon,null),expanded?React.createElement(ExpandLessIcon,null):React.createElement(ExpandMoreIcon,null)))))))))));}var useStyles=makeStyles(function(theme){return{mainWrap:{backgroundColor:\"rgba(0,0,0,0.1)\"},mainContainer:{padding:0},mainGridContainer:{wieght:\"100%\",backgroundSize:\"cover\",backgroundPosition:\"center\",// filter: \"blur(4px),\"\ncolor:\"white\"},profileTopBox:{zIndex:2,// background: \"linear-gradient(90deg, rgba(76,113,209,1) 0%, rgba(162,88,222,1) 100%)\",\nwidth:\"100%\",height:\"100%\",paddingBottom:5},gridDropzone:{width:\"100%\",margin:theme.spacing(3,0,2)},oneLineDescription:{width:\"100%\",marginTop:10,padding:10,textAlign:\"center\",whiteSpace:'nowrap',overflow:'hidden',textOverflow:'ellipsis'},centerText:{textAlign:\"center\",marginTop:10},buttonContainer:{width:\"100%\",marginBottom:10},descWrap:{width:\"100%\",padding:5},textFieldDesc:{margin:5,width:\"100%\",borderRadius:5,backgroundColor:\"rgba(255,255,255,0.6)\"},standardHeading:{width:'100%',fontWeight:500,// color: \"lightGrey\",\ntextAlign:'left',padding:10,whiteSpace:'nowrap',overflow:'hidden',textOverflow:'ellipsis'},avatar:{height:80,width:80,margin:theme.spacing(1),backgroundColor:theme.palette.secondary.main,boxShadow:\"4px 3px 5px 0px rgba(0,0,0,0.5)\"},outButton:{color:\"white\",fontWeight:600,height:40,width:120,backgroundColor:\"rgba(0,0,0,0.3)\",boxShadow:\"4px 3px 5px 0px rgba(0,0,0,0.5)\"},settingsButton:{color:\"white\",height:40,width:120,backgroundColor:\"rgba(0,0,0,0.3)\",boxShadow:\"4px 3px 5px 0px rgba(0,0,0,0.5)\"},saveButton:{color:\"white\",height:40,width:\"100%\",marginTop:10,marginBottom:15,boxShadow:\"4px 3px 5px 0px rgba(0,0,0,0.5)\"}};});","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Molecules/profile/ProfileTopBox.js"],"names":["React","useState","useContext","useRef","useEffect","Container","Grid","ExitToAppIcon","Typography","IconButton","LockOutlinedIcon","CreateIcon","ExpandMoreIcon","ExpandLessIcon","Avatar","Button","Rating","Collapse","TextField","makeStyles","NavLink","useHistory","useMutation","UPDATE_USER","PROFILE_DATA","findEmpty","useXsSize","useAverageRating","UserContext","DropzoneSignup","ProfileTopBox","errorQuery","showRatings","classes","useStyles","history","md_size_memo","context","expanded","setExpanded","picture","formValue","setFormValue","updateUser","loading","error","data","inputName","inputEmail","inputDescription","averageRating","dataOut","undefined","errorOut","success","getLoggedInUser","onSubmitHandler","e","preventDefault","console","log","current","value","load","_id","name","email","description","empty","map","item","password","password2","push","length","variables","refetchQueries","query","host_id","mainWrap","mainContainer","background","mainGridContainer","paddingTop","profileTopBox","avatar","width","centerText","oneLineDescription","descWrap","gridDropzone","textFieldDesc","saveButton","buttonContainer","outButton","settingsButton","theme","backgroundColor","padding","wieght","backgroundSize","backgroundPosition","color","zIndex","height","paddingBottom","margin","spacing","marginTop","textAlign","whiteSpace","overflow","textOverflow","marginBottom","borderRadius","standardHeading","fontWeight","palette","secondary","main","boxShadow"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useRef, useEffect } from \"react\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\";\nimport Typography from \"@material-ui/core/Typography\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport CreateIcon from \"@material-ui/icons/Create\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Button from \"@material-ui/core/Button\";\nimport Rating from \"@material-ui/lab/Rating\";\nimport Collapse from \"@material-ui/core/Collapse\";\nimport TextField from \"@material-ui/core/TextField\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport { NavLink, useHistory } from \"react-router-dom\";\nimport { useMutation } from \"@apollo/react-hooks\";\n\nimport { UPDATE_USER } from \"src/Services/GQL/UPDATE_USER\";\nimport { PROFILE_DATA } from \"src/Services/GQL/PROFILE_DATA\";\n\nimport { findEmpty } from \"src/Services/functions\";\nimport { useXsSize } from \"src/Hooks/useXsSize\";\nimport { useAverageRating } from \"src/Hooks/useAverageRating\";\nimport { UserContext } from \"src/userContext\";\n\nimport DropzoneSignup from \"src/Molecules/DropzoneSignup\";\n\nexport default function ProfileTopBox({ errorQuery, showRatings }) {\n  const classes = useStyles();\n  const history = useHistory();\n  const { md_size_memo } = useXsSize();\n  const { context } = useContext(UserContext);\n  const [expanded, setExpanded] = useState(false)\n  const [formValue, setFormValue] = useState({ picture: context.picture });\n  const [updateUser, { loading, error, data }] = useMutation(UPDATE_USER);\n\n  const inputName = useRef(null);\n  const inputEmail = useRef(null);\n  const inputDescription = useRef(null);\n\n  const { averageRating } = useAverageRating(showRatings)\n\n  const { dataOut } = data ? data.updateUser : { dataOut: undefined };\n  const { errorOut } = data ? data.updateUser : { errorOut: undefined };\n  \n\n  useEffect(() => {\n    if(dataOut && dataOut.success){\n      context.getLoggedInUser()\n    }\n  }, [dataOut])\n\n\n\n  const onSubmitHandler = (e) => {\n    e.preventDefault();\n    console.log(\"Updating: \", inputName.current.value, inputEmail.current.value, inputDescription.current.value)\n    let load = {\n      _id: context._id,\n      name: inputName.current.value,\n      email: inputEmail.current.value,\n      description: inputDescription.current.value,\n      picture: formValue ? formValue.picture : context.picture,\n      };\n    let empty = findEmpty(load);\n    empty = empty.map(item => `${item} is Empty`)\n    if(load.password != load.password2) empty.push(\"Not matching passwords\")\n\n    console.log(\"Empty ones: \", empty);\n\n  if (empty.length == 0) {\n      updateUser({\n        variables: load,\n        refetchQueries: () => [\n          {\n            query: PROFILE_DATA,\n            variables: { host_id: context._id }\n          }\n        ]\n      })\n      setExpanded(!expanded)\n  } else {\n      // setFEerrors(empty);\n    }\n}\n\n\n\n\n  return (\n    <div className={classes.mainWrap}>\n    <Container\n    maxWidth=\"sm\"\n    className={classes.mainContainer}\n  >\n      <Grid\n        container\n        justify=\"center\"\n        direction=\"column\"\n        alignItems=\"center\"\n        style={{\n          // backgroundImage: `url(${context.picture})`,\n          background: md_size_memo\n            ? null\n            : \"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(123,81,117,1) 100%)\"\n        }}\n        className={classes.mainGridContainer}\n      >\n        <Grid\n          item\n          style={{ paddingTop: md_size_memo ? 80 : 40 }}\n          className={classes.profileTopBox}\n        >\n          {expanded ? null \n          :\n          <>\n          <Grid container direction=\"row\" justify=\"center\">\n          <Grid item>\n            <Grid container justify=\"center\">\n              <Grid item>\n                <Avatar className={classes.avatar} src={context.picture}>\n                  <LockOutlinedIcon />\n                </Avatar>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n          <Grid\n          container\n          justify=\"center\"\n          alignItems=\"center\"\n          style={{ width: \"100%\" }}\n        >\n          <Grid item xs={12}>\n            <Typography component=\"h1\" variant=\"h5\" className={classes.centerText}>\n              {context.name}\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            <Typography variant=\"body1\" className={classes.centerText}>\n              {context.email}\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            <Typography variant=\"body1\" className={classes.centerText}>\n              <Rating name=\"simple-controlled\" readOnly value={averageRating} />\n            </Typography>\n          </Grid>\n          <Grid item xs={12}>\n            <Typography variant=\"body1\" className={classes.oneLineDescription}>\n                {context.description}\n            </Typography>\n            <Typography variant=\"body1\" className={classes.oneLineDescription}>\n                {errorQuery && <h1>ERROR while loading profile data</h1>}\n            </Typography>\n          </Grid>\n        </Grid>\n          </>\n          }\n\n          <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\n        <Grid item className={classes.descWrap}>\n        <Grid\n            container\n            justify=\"center\"\n            alignItems=\"center\"\n            direction=\"column\"\n            className={classes.gridDropzone}\n          >\n            <Grid item>\n              <DropzoneSignup setFormValue={setFormValue} formValue={formValue} />\n            </Grid>\n          </Grid>\n        {/* <Typography variant=\"body1\" className={classes.standardHeading}>NAME</Typography> */}\n              <TextField\n                      id=\"outlined-basic\"\n                      label=\"Name\"\n                      variant=\"filled\"\n                      defaultValue={context.name}\n                      inputRef={inputName}\n                      className={classes.textFieldDesc}\n                      multiline\n                      rows=\"1\"\n                    />\n        {/* <Typography variant=\"body1\" className={classes.standardHeading}>EMAIL</Typography> */}\n        <TextField\n                      id=\"outlined-basic\"\n                      label=\"Email\"\n                      variant=\"filled\"\n                      disabled\n                      defaultValue={context.email}\n                      inputRef={inputEmail}\n                      className={classes.textFieldDesc}\n                      multiline\n                      rows=\"1\"\n                    />\n        {/* <Typography variant=\"body1\" className={classes.standardHeading}>DESCRIPTION</Typography> */}\n        <TextField\n                id=\"outlined-basic\"\n                label=\"Description\"\n                variant=\"filled\"\n                defaultValue={context.description}\n                inputRef={inputDescription}\n                className={classes.textFieldDesc}\n                multiline\n                rows=\"4\"\n              />\n        <Button\n                  type=\"submit\"\n                  fullWidth\n                  variant=\"contained\"\n                  color=\"primary\"\n                  className={classes.saveButton}\n                  onClick={e => {\n                    onSubmitHandler(e)\n                  }}\n                >\n                  SAVE\n                </Button>\n              </Grid>\n        </ Collapse>\n        <Grid item xs={12}>\n              <Grid container className={classes.buttonContainer}>\n              <Grid item xs={6}>\n                <Grid container justify=\"center\">\n                  <Grid item>\n                    <Button\n                      className={classes.outButton}\n                      onClick={() => {history.push(`/signout`); }}\n                    >\n                      SIGN OUT\n                      {/* <ExitToAppIcon /> */}\n                    </Button>\n                  </Grid>\n                </Grid>\n              </Grid>\n              <Grid item xs={6}>\n                <Grid container justify=\"center\">\n                  <Grid item onClick={() => {setExpanded(!expanded)}}>\n                  <Button className={classes.settingsButton}>\n                    <CreateIcon />\n                    \n                    {expanded ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n                  </Button>\n                </Grid>\n                </Grid>\n                </Grid>\n              </Grid>\n            </Grid>\n       \n        </Grid>\n      </Grid>\n    </Container>\n    </div>\n  );\n}\n\nconst useStyles = makeStyles(theme => ({\n  mainWrap: {\n    backgroundColor: \"rgba(0,0,0,0.1)\",\n  },\n  mainContainer: {\n    padding: 0\n  },\n  mainGridContainer: {\n    wieght: \"100%\",\n    backgroundSize: \"cover\",\n    backgroundPosition: \"center\",\n    // filter: \"blur(4px),\"\n    color: \"white\"\n  },\n  profileTopBox: {\n    zIndex: 2,\n    // background: \"linear-gradient(90deg, rgba(76,113,209,1) 0%, rgba(162,88,222,1) 100%)\",\n    width: \"100%\",\n    height: \"100%\",\n    paddingBottom: 5\n  },\n  gridDropzone: {\n    width: \"100%\",\n    margin: theme.spacing(3, 0, 2)\n  },\n  oneLineDescription: {\n    width: \"100%\",\n    marginTop: 10,\n    padding: 10,\n    textAlign: \"center\",\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  centerText:{\n    textAlign: \"center\",\n    marginTop: 10\n  },\n  buttonContainer: {\n    width: \"100%\",\n    marginBottom: 10\n  },\n  descWrap: {\n    width: \"100%\",\n    padding: 5,\n  },\n  textFieldDesc: {\n    margin: 5,\n    width: \"100%\",\n    borderRadius: 5,\n    backgroundColor: \"rgba(255,255,255,0.6)\"\n  },\n  standardHeading: {\n    width: '100%',\n    fontWeight: 500,\n    // color: \"lightGrey\",\n    textAlign: 'left',\n    padding: 10,\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n  avatar: {\n    height: 80,\n    width: 80,\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.secondary.main,\n    boxShadow: \"4px 3px 5px 0px rgba(0,0,0,0.5)\"\n  },\n  outButton: {\n    color: \"white\",\n    fontWeight: 600,\n    height: 40,\n    width: 120,\n    backgroundColor: \"rgba(0,0,0,0.3)\",\n    boxShadow: \"4px 3px 5px 0px rgba(0,0,0,0.5)\"\n  },\n  settingsButton: {\n    color: \"white\",\n    height: 40,\n    width: 120,\n    backgroundColor: \"rgba(0,0,0,0.3)\",\n    boxShadow: \"4px 3px 5px 0px rgba(0,0,0,0.5)\"\n  },\n  saveButton: {\n    color: \"white\",\n    height: 40,\n    width: \"100%\",\n    marginTop: 10,\n    marginBottom: 15,\n    boxShadow: \"4px 3px 5px 0px rgba(0,0,0,0.5)\"\n  },\n}));\n"]},"metadata":{},"sourceType":"module"}