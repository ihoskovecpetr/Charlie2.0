{"ast":null,"code":"import _defineProperty from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useContext,useState,useMemo,useCallback}from\"react\";//import GeolocationMarker from 'geolocation-marker'\nimport TextField from\"@material-ui/core/TextField\";import Grid from\"@material-ui/core/Grid\";// import { GeolocationMarker } from 'geolocation-marker'\nimport GeolocationMarker from'geolocation-marker';import{UserContext}from\"../userContext\";import Map from\"../Atoms/MapAtom\";var LngLatCenter={lat:50.068645,lng:14.457364};function MapCreate(props){//const { latitude, longitude, error } = usePosition();\nvar _useContext=useContext(UserContext),context=_useContext.context;var _useState=useState(\"Write address\"),_useState2=_slicedToArray(_useState,2),addressTxt=_useState2[0],setAddressTxt=_useState2[1];var marker;//let markerGeoLoc = { lat: latitude, lng: longitude };\nvar geocoder;//console.log(\"RENDER CREATE MAP: position: \", markerGeoLoc);\nif(context.geolocationObj){LngLatCenter=context.geolocationObj;}var MapOptions=useMemo(function(){return{center:LngLatCenter,zoom:10,disableDefaultUI:true,zoomControl:true,//mapTypeId: window.google.maps.MapTypeId.ROADMAP,\nclickableIcons:false,gestureHandling:\"cooperative\"};},[LngLatCenter]);var onMapMount=useCallback(function(map){marker=new window.google.maps.Marker({map:map,anchorPoint:new window.google.maps.Point(0,-29)});var GeoMarker=new window.GeolocationMarker(map);var input=document.getElementById(\"input-location\");var autocomplete=new window.google.maps.places.Autocomplete(input);geocoder=new window.google.maps.Geocoder();autocomplete.bindTo(\"bounds\",map);if(props.customMapParam){marker.setPosition({lng:props.customMapParam.lng,lat:props.customMapParam.lat});map.panTo({lng:props.customMapParam.lng,lat:props.customMapParam.lat});map.setZoom(props.customMapParam.zoom);document.getElementById(\"input-location\").value=props.customMapParam.address;}else if(LngLatCenter){marker.setPosition(LngLatCenter);map.panTo(LngLatCenter);geocodeLatLng(geocoder,map,LngLatCenter.lat,LngLatCenter.lng);}map.addListener(\"zoom_changed\",function(){props.setCustomMapParam(function(prev){return _objectSpread({},prev,{zoom:map.zoom});});});map.addListener(\"click\",function(e){document.getElementById(\"input-location\").value=\"\";marker.setVisible(false);marker.setPosition(e.latLng);marker.setVisible(true);console.log(\"Click\");geocodeLatLng(geocoder,map,e.latLng.lat(),e.latLng.lng());});autocomplete.addListener(\"place_changed\",function(){marker.setVisible(false);var place=autocomplete.getPlace();if(!place.geometry){// User entered the name of a Place that was not suggested and\n// pressed the Enter key, or the Place Details request failed.\n//window.alert(\"No details available for input: '\" + place.name + \"'\");\nreturn;}// If the place has a geometry, then present it on a map.\nif(place.geometry.viewport){map.fitBounds(place.geometry.viewport);marker.setPosition(place.geometry.location);marker.setVisible(true);}else{//console.log(\"Setting here center: \", place.geometry.location);\nmap.setCenter(place.geometry.location);map.setZoom(17);}LngLatCenter={lat:place.geometry.location.lat(),lng:place.geometry.location.lng()};var address=\"\";if(place.address_components){address=[place.address_components[0]&&place.address_components[0].short_name||\"\",place.address_components[1]&&place.address_components[1].short_name||\"\",place.address_components[2]&&place.address_components[2].short_name||\"\"].join(\" \");}console.log(\"Tohle place ma addresu: \",place.address_components);props.setCustomMapParam(function(prev){return _objectSpread({},prev,{lat:place.geometry.location.lat(),lng:place.geometry.location.lng(),address:address,zoom:map.zoom,uncontrolledAdr:false});});});},[]);var geocodeLatLng=function geocodeLatLng(geocoder,map,lat,lng){geocoder.geocode({location:{lat:lat,lng:lng}},function(results,status,error_message){//console.log(\"results: \", results, status, error_message);\nvar shortAddress;if(results){console.log(\"Agres: \",results);var spl=results[0].formatted_address.split(\" \");// shortAddress = [spl[0], spl[1], spl[2], spl[3]].join(\" \");\nshortAddress=results[0].formatted_address;}else{shortAddress=\"Google did not find address for this location.\";}status&&props.setCustomMapParam(function(prev){return _objectSpread({},prev,{address:shortAddress,lat:lat,lng:lng,zoom:map.zoom,uncontrolledAdr:false});});if(error_message){window.alert(\"Geocoder failed due to: \"+status);//this.setState({addressOffer: \"No address in your location\"})\n// props.setCustomMapParam(prev => {\n//   return { ...prev, address: \"Failed to localize you\" };\n// });\n}});};var MapAtom=useMemo(function(){return React.createElement(Map,{onMount:onMapMount,options:MapOptions,className:\"Create-hell-of-a-party\",styling:{height:\"200px\",width:\"100%\",marginBottom:20}});},[onMapMount,MapOptions]);return React.createElement(React.Fragment,null,React.createElement(Grid,{container:true},React.createElement(Grid,{item:true,style:{width:\"100%\"}},React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"input-location\",name:\"address\",autoComplete:\"address\",style:{marginBottom:0,display:props.customMapParam&&props.customMapParam.uncontrolledAdr?\"block\":\"none\"},onKeyPress:function onKeyPress(e){if(e.key===\"Enter\")e.preventDefault();},autoFocus:true}),React.createElement(TextField,{variant:\"outlined\",margin:\"normal\",required:true,fullWidth:true,id:\"input-location-controlled\",value:props.customMapParam&&props.customMapParam.address?props.customMapParam.address:\"no address yet\"//label=\"Enter a location\"\n//placeholder=\"Enter a location\"\n,name:\"address\",style:{marginBottom:0,display:props.customMapParam&&props.customMapParam.uncontrolledAdr&&\"none\"},disabled:true,onKeyPress:function onKeyPress(e){if(e.key===\"Enter\")e.preventDefault();},onClick:function onClick(){props.setCustomMapParam(function(prev){return _objectSpread({},prev,{uncontrolledAdr:true});});},autoFocus:true}))),MapAtom);}export default React.memo(MapCreate);","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Molecules/MapCreate.js"],"names":["React","useContext","useState","useMemo","useCallback","TextField","Grid","GeolocationMarker","UserContext","Map","LngLatCenter","lat","lng","MapCreate","props","context","addressTxt","setAddressTxt","marker","geocoder","geolocationObj","MapOptions","center","zoom","disableDefaultUI","zoomControl","clickableIcons","gestureHandling","onMapMount","map","window","google","maps","Marker","anchorPoint","Point","GeoMarker","input","document","getElementById","autocomplete","places","Autocomplete","Geocoder","bindTo","customMapParam","setPosition","panTo","setZoom","value","address","geocodeLatLng","addListener","setCustomMapParam","prev","e","setVisible","latLng","console","log","place","getPlace","geometry","viewport","fitBounds","location","setCenter","address_components","short_name","join","uncontrolledAdr","geocode","results","status","error_message","shortAddress","spl","formatted_address","split","alert","MapAtom","height","width","marginBottom","display","key","preventDefault","memo"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useMemo, useCallback } from \"react\";\n//import GeolocationMarker from 'geolocation-marker'\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\n// import { GeolocationMarker } from 'geolocation-marker'\nimport GeolocationMarker from 'geolocation-marker'\n\nimport { UserContext } from \"../userContext\";\n\nimport Map from \"../Atoms/MapAtom\";\n\nlet LngLatCenter = { lat: 50.068645, lng: 14.457364 };\n\nfunction MapCreate(props) {\n  //const { latitude, longitude, error } = usePosition();\n  const { context } = useContext(UserContext);\n  const [addressTxt, setAddressTxt] = useState(\"Write address\");\n  let marker;\n  //let markerGeoLoc = { lat: latitude, lng: longitude };\n  let geocoder;\n\n  //console.log(\"RENDER CREATE MAP: position: \", markerGeoLoc);\n\n  if (context.geolocationObj) {\n    LngLatCenter = context.geolocationObj;\n  }\n\n  const MapOptions = useMemo(() => {\n    return {\n      center: LngLatCenter,\n      zoom: 10,\n      disableDefaultUI: true,\n      zoomControl: true,\n      //mapTypeId: window.google.maps.MapTypeId.ROADMAP,\n      clickableIcons: false,\n      gestureHandling: \"cooperative\"\n    };\n  }, [LngLatCenter]);\n\n  const onMapMount = useCallback(map => {\n\n    marker = new window.google.maps.Marker({\n      map: map,\n      anchorPoint: new window.google.maps.Point(0, -29)\n    });\n\n    var GeoMarker = new window.GeolocationMarker(map);\n\n    var input = document.getElementById(\"input-location\");\n    var autocomplete = new window.google.maps.places.Autocomplete(input);\n    geocoder = new window.google.maps.Geocoder();\n    autocomplete.bindTo(\"bounds\", map);\n\n    if (props.customMapParam) {\n      marker.setPosition({\n        lng: props.customMapParam.lng,\n        lat: props.customMapParam.lat\n      });\n      map.panTo({\n        lng: props.customMapParam.lng,\n        lat: props.customMapParam.lat\n      });\n      map.setZoom(props.customMapParam.zoom);\n      document.getElementById(\"input-location\").value =\n        props.customMapParam.address;\n    } else if (LngLatCenter) {\n      marker.setPosition(LngLatCenter);\n      map.panTo(LngLatCenter);\n      geocodeLatLng(geocoder, map, LngLatCenter.lat, LngLatCenter.lng);\n    }\n    map.addListener(\"zoom_changed\", function() {\n      props.setCustomMapParam(prev => {\n        return {\n          ...prev,\n          zoom: map.zoom\n        };\n      });\n    });\n\n    map.addListener(\"click\", e => {\n      document.getElementById(\"input-location\").value = \"\";\n      marker.setVisible(false);\n      marker.setPosition(e.latLng);\n      marker.setVisible(true);\n      console.log(\"Click\")\n\n      geocodeLatLng(geocoder, map, e.latLng.lat(), e.latLng.lng());\n    });\n\n    autocomplete.addListener(\"place_changed\", function() {\n      marker.setVisible(false);\n      var place = autocomplete.getPlace();\n      if (!place.geometry) {\n        // User entered the name of a Place that was not suggested and\n        // pressed the Enter key, or the Place Details request failed.\n        //window.alert(\"No details available for input: '\" + place.name + \"'\");\n        return;\n      }\n\n      // If the place has a geometry, then present it on a map.\n      if (place.geometry.viewport) {\n        map.fitBounds(place.geometry.viewport);\n        marker.setPosition(place.geometry.location);\n        marker.setVisible(true);\n      } else {\n        //console.log(\"Setting here center: \", place.geometry.location);\n        map.setCenter(place.geometry.location);\n        map.setZoom(17);\n      }\n\n      LngLatCenter = {\n        lat: place.geometry.location.lat(),\n        lng: place.geometry.location.lng()\n      };\n\n      let address = \"\";\n\n      if (place.address_components) {\n        address = [\n          (place.address_components[0] &&\n            place.address_components[0].short_name) ||\n            \"\",\n          (place.address_components[1] &&\n            place.address_components[1].short_name) ||\n            \"\",\n          (place.address_components[2] &&\n            place.address_components[2].short_name) ||\n            \"\"\n        ].join(\" \");\n      }\n\n      console.log(\n        \"Tohle place ma addresu: \",\n        place.address_components\n      );\n\n      props.setCustomMapParam(prev => {\n        return {\n          ...prev,\n          lat: place.geometry.location.lat(),\n          lng: place.geometry.location.lng(),\n          address: address,\n          zoom: map.zoom,\n          uncontrolledAdr: false\n        };\n      });\n    });\n  }, []);\n\n  const geocodeLatLng = (geocoder, map, lat, lng) => {\n    geocoder.geocode({ location: { lat: lat, lng: lng } }, function(\n      results,\n      status,\n      error_message\n    ) {\n      //console.log(\"results: \", results, status, error_message);\n      var shortAddress;\n      if (results) {\n        console.log(\"Agres: \", results)\n        var spl = results[0].formatted_address.split(\" \");\n        // shortAddress = [spl[0], spl[1], spl[2], spl[3]].join(\" \");\n        shortAddress = results[0].formatted_address\n      } else {\n        shortAddress = \"Google did not find address for this location.\";\n      }\n\n      status &&\n        props.setCustomMapParam(prev => {\n          return {\n            ...prev,\n            address: shortAddress,\n            lat: lat,\n            lng: lng,\n            zoom: map.zoom,\n            uncontrolledAdr: false\n          };\n        });\n      if (error_message) {\n        window.alert(\"Geocoder failed due to: \" + status);\n        //this.setState({addressOffer: \"No address in your location\"})\n        // props.setCustomMapParam(prev => {\n        //   return { ...prev, address: \"Failed to localize you\" };\n        // });\n      }\n    });\n  };\n\n  const MapAtom = useMemo(\n    () => (\n      <Map\n        onMount={onMapMount}\n        options={MapOptions}\n        className=\"Create-hell-of-a-party\"\n        styling={{\n          height: \"200px\",\n          width: \"100%\",\n          marginBottom: 20\n        }}\n      />\n    ),\n    [onMapMount, MapOptions]\n  );\n\n  return (\n    <>\n      <Grid container>\n        <Grid item style={{ width: \"100%\" }}>\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            id=\"input-location\"\n            name=\"address\"\n            autoComplete=\"address\"\n            style={{\n              marginBottom: 0,\n              display:\n                props.customMapParam && props.customMapParam.uncontrolledAdr\n                  ? \"block\"\n                  : \"none\"\n            }}\n            onKeyPress={e => {\n              if (e.key === \"Enter\") e.preventDefault();\n            }}\n            autoFocus\n          />\n          <TextField\n            variant=\"outlined\"\n            margin=\"normal\"\n            required\n            fullWidth\n            id=\"input-location-controlled\"\n            value={\n              props.customMapParam && props.customMapParam.address\n                ? props.customMapParam.address\n                : \"no address yet\"\n            }\n            //label=\"Enter a location\"\n            //placeholder=\"Enter a location\"\n            name=\"address\"\n            style={{\n              marginBottom: 0,\n              display:\n                props.customMapParam &&\n                props.customMapParam.uncontrolledAdr &&\n                \"none\"\n            }}\n            disabled\n            onKeyPress={e => {\n              if (e.key === \"Enter\") e.preventDefault();\n            }}\n            onClick={() => {\n              props.setCustomMapParam(prev => {\n                return {\n                  ...prev,\n                  uncontrolledAdr: true\n                };\n              });\n            }}\n            autoFocus\n          />\n        </Grid>\n      </Grid>\n      {MapAtom}\n    </>\n  );\n}\n\nexport default React.memo(MapCreate);\n"]},"metadata":{},"sourceType":"module"}