{"ast":null,"code":"import _defineProperty from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Molecules/play/JoinSend.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  mutation requestBookEvent(\\n    $event_id: String!\\n    $guest_id: String!\\n    $guest_name: String!\\n    $message: String!\\n  ) {\\n    requestBookEvent(\\n      event_id: $event_id\\n      guest_id: $guest_id\\n      guest_name: $guest_name\\n      message: $message\\n    ) {\\n      _id\\n      success\\n      message\\n    }\\n  }\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useRef, useEffect } from \"react\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Chip from '@material-ui/core/Chip';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport DoneIcon from '@material-ui/icons/Done';\nimport CloseIcon from '@material-ui/icons/Close';\nimport HourglassEmptyIcon from '@material-ui/icons/HourglassEmpty';\nimport WhatshotIcon from '@material-ui/icons/Whatshot';\nimport SendIcon from '@material-ui/icons/Send';\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline';\nimport clsx from \"clsx\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { useHistory } from \"react-router-dom\";\nimport { Animated } from \"react-animated-css\";\nimport { PROFILE_DATA } from \"src/Services/GQL/PROFILE_DATA\";\nimport { GET_ONE_EVENT } from \"src/Services/GQL/GET_ONE_EVENT\";\nimport { EVENT_BOOKINGS } from \"src/Services/GQL/EVENT_BOOKINGS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\nimport Spinner from \"../../Atoms/Spinner\";\nconst BOOKING_REQ = gql(_templateObject());\nexport default function JoinSend({\n  event,\n  localContext\n}) {\n  const classes = useStyles();\n  let history = useHistory();\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        checked = _useState2[0],\n        setChecked = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        sending = _useState4[0],\n        setSending = _useState4[1]; // const [refetched, setRefetched] = useState(false);\n\n\n  const _useState5 = useState({\n    message: \"JOIN\",\n    pending: false,\n    attending: false,\n    icon: [React.createElement(WhatshotIcon, {\n      fontSize: \"large\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    })]\n  }),\n        _useState6 = _slicedToArray(_useState5, 2),\n        localState = _useState6[0],\n        setLocalState = _useState6[1];\n\n  const _useMutation = useMutation(BOOKING_REQ),\n        _useMutation2 = _slicedToArray(_useMutation, 2),\n        createReqBooking = _useMutation2[0],\n        _useMutation2$ = _useMutation2[1],\n        loading = _useMutation2$.loading,\n        error = _useMutation2$.error,\n        data = _useMutation2$.data;\n\n  const inputDescription = useRef(null);\n  console.log(\"JOIN SEND RERENDER\");\n  useEffect(() => {\n    event && event.bookings && event.bookings.map(item => {\n      if (item.user._id === localContext._id) {\n        if (item.decided && item.confirmed) {\n          // attending = true\n          // icon = [<DoneIcon fontSize=\"large\" />]\n          setLocalState(prev => {\n            {\n              return _objectSpread({}, prev, {\n                message: \"Attending\",\n                attending: true,\n                icon: [React.createElement(DoneIcon, {\n                  fontSize: \"large\",\n                  __source: {\n                    fileName: _jsxFileName,\n                    lineNumber: 79\n                  },\n                  __self: this\n                })]\n              });\n            }\n          });\n        }\n      }\n    });\n  }, [event, event.bookings, localContext._id]);\n\n  function openJoin() {\n    if (!localState.attending && !localState.pending) {\n      setChecked(true);\n      setTimeout(() => {\n        window.scrollBy({\n          top: 200,\n          left: 0,\n          behavior: 'smooth'\n        });\n      }, 100);\n      setTimeout(() => {\n        document.getElementById(\"bottomAnchor\").scrollIntoView();\n      }, 400);\n    }\n  }\n\n  function sendBooking(params) {\n    setLocalState(prev => _objectSpread({}, prev, {\n      message: \"Sending\",\n      attending: true,\n      icon: [React.createElement(HourglassEmptyIcon, {\n        fontSize: \"large\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      })]\n    }));\n    createReqBooking({\n      variables: {\n        guest_id: localContext._id,\n        guest_name: localContext.name,\n        event_id: event._id,\n        message: inputDescription.current.value ? inputDescription.current.value : null\n      },\n      refetchQueries: () => [{\n        query: PROFILE_DATA,\n        variables: {\n          host_id: localContext._id\n        }\n      }, {\n        query: GET_ONE_EVENT,\n        variables: {\n          event_id: history.location.pathname.split(\"/\")[2]\n        }\n      }, {\n        query: EVENT_BOOKINGS,\n        variables: {\n          event_id: event._id\n        }\n      }, {\n        query: PLAY_EVENTS_QUERY,\n        variables: {\n          plusDays: localContext.filterOn ? localContext.plusDays : 10000,\n          lng: localContext.geolocationObj ? localContext.geolocationObj.lng : null,\n          lat: localContext.geolocationObj ? localContext.geolocationObj.lat : null,\n          radius: localContext.filterOn ? localContext.radius : 9999999,\n          shownEvents: localContext.shownEvents\n        }\n      }]\n    });\n    setChecked(false);\n  }\n\n  if (event.areYouAuthor) return React.createElement(\"p\", {\n    className: classes.textAuthor,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, \" You are author of this event \");\n  return React.createElement(React.Fragment, null, React.createElement(Chip, {\n    label: \"\".concat(localState.message) // icon={attending && <DoneIcon fontSize=\"large\" />}\n    ,\n    icon: localState.icon[0] //variant=\"outlined\" \n    ,\n    color: \"secondary\",\n    className: classes.chipOne,\n    onClick: openJoin,\n    disabled: checked || localState.attending || localState.pending,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }), React.createElement(Grid, {\n    container: true,\n    className: clsx(classes.sendJoinContainer, checked && classes.openSend),\n    alignItems: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, !loading && !data && React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    className: clsx(classes.itemSend, checked && classes.displayBlock),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(Animated, {\n    animationIn: \"fadeIn\",\n    animationOut: \"fadeOut\",\n    animationInDelay: 500 //animationInDuration={5000}\n    ,\n    isVisible: true,\n    infinite: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(InputLabel, {\n    htmlFor: \"standard-adornment-amount\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"YOUR MESSAGE\"), React.createElement(TextField, {\n    variant: \"outlined\",\n    margin: \"normal\",\n    required: true,\n    fullWidth: true,\n    defaultValue: \"Hi, let me please come and pay you money :)\",\n    multiline: true,\n    rows: \"4\",\n    color: \"primary\",\n    inputRef: inputDescription,\n    name: \"decsription\",\n    autoComplete: \"false\",\n    className: classes.textField,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }), React.createElement(Chip, {\n    label: \"SEND\",\n    color: \"secondary\",\n    icon: React.createElement(SendIcon, {\n      fontSize: \"large\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }),\n    className: classes.chipSend,\n    onClick: sendBooking,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    id: \"bottomAnchor\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  })), loading && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    height: 100,\n    width: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }))), !loading && data && data.requestBookEvent && React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    className: clsx(classes.itemSend, checked && classes.displayBlock),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  }, React.createElement(InputLabel, {\n    htmlFor: \"standard-adornment-amount\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, \"Finished\"))));\n}\nconst useStyles = makeStyles(theme => ({\n  sendJoinContainer: {\n    backgroundColor: \"white\",\n    height: 0,\n    overflow: 'hidden',\n    transition: 'height 0.6s',\n    transitionTimingFunction: 'ease-out'\n  },\n  openSend: {\n    display: \"block\",\n    height: 248,\n    padding: 10\n  },\n  textAuthor: {\n    textAlign: \"center\"\n  },\n  itemSend: {\n    display: \"none\"\n  },\n  displayBlock: {\n    display: \"block\"\n  },\n  chipOne: {\n    width: \"90%\",\n    fontWeight: 500,\n    fontSize: 25,\n    padding: 20,\n    margin: \"5%\"\n  },\n  chipSend: {\n    width: \"90%\",\n    fontWeight: 500,\n    fontSize: 25,\n    padding: 20,\n    margin: \"5%\"\n  }\n}));","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Molecules/play/JoinSend.js"],"names":["React","useState","useRef","useEffect","Grid","Chip","makeStyles","useTheme","TextField","InputLabel","DoneIcon","CloseIcon","HourglassEmptyIcon","WhatshotIcon","SendIcon","CheckCircleOutlineIcon","clsx","useMutation","gql","useHistory","Animated","PROFILE_DATA","GET_ONE_EVENT","EVENT_BOOKINGS","PLAY_EVENTS_QUERY","Spinner","BOOKING_REQ","JoinSend","event","localContext","classes","useStyles","history","checked","setChecked","sending","setSending","message","pending","attending","icon","localState","setLocalState","createReqBooking","loading","error","data","inputDescription","console","log","bookings","map","item","user","_id","decided","confirmed","prev","openJoin","setTimeout","window","scrollBy","top","left","behavior","document","getElementById","scrollIntoView","sendBooking","params","variables","guest_id","guest_name","name","event_id","current","value","refetchQueries","query","host_id","location","pathname","split","plusDays","filterOn","lng","geolocationObj","lat","radius","shownEvents","areYouAuthor","textAuthor","chipOne","sendJoinContainer","openSend","itemSend","displayBlock","textField","chipSend","loadingGridCont","requestBookEvent","theme","backgroundColor","height","overflow","transition","transitionTimingFunction","display","padding","textAlign","width","fontWeight","fontSize","margin"],"mappings":"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","sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Chip from '@material-ui/core/Chip';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport TextField from \"@material-ui/core/TextField\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport DoneIcon from '@material-ui/icons/Done';\nimport CloseIcon from '@material-ui/icons/Close';\nimport HourglassEmptyIcon from '@material-ui/icons/HourglassEmpty';\nimport WhatshotIcon from '@material-ui/icons/Whatshot';\nimport SendIcon from '@material-ui/icons/Send';\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline';\n\nimport clsx from \"clsx\";\nimport { useMutation } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\nimport { useHistory } from \"react-router-dom\";\nimport { Animated } from \"react-animated-css\";\n\nimport { PROFILE_DATA } from \"src/Services/GQL/PROFILE_DATA\";\nimport { GET_ONE_EVENT } from \"src/Services/GQL/GET_ONE_EVENT\";\nimport { EVENT_BOOKINGS } from \"src/Services/GQL/EVENT_BOOKINGS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nimport Spinner from \"../../Atoms/Spinner\";\n\n\nconst BOOKING_REQ = gql`\n  mutation requestBookEvent(\n    $event_id: String!\n    $guest_id: String!\n    $guest_name: String!\n    $message: String!\n  ) {\n    requestBookEvent(\n      event_id: $event_id\n      guest_id: $guest_id\n      guest_name: $guest_name\n      message: $message\n    ) {\n      _id\n      success\n      message\n    }\n  }\n`;\n\nexport default function JoinSend({event, localContext}) {\n    const classes = useStyles();\n    let history = useHistory();\n    const [checked, setChecked] = useState(false);\n    const [sending, setSending] = useState(false);\n    // const [refetched, setRefetched] = useState(false);\n\n    const [localState, setLocalState] = useState({\n      message: \"JOIN\",\n      pending: false,\n      attending: false,\n      icon: [<WhatshotIcon fontSize=\"large\" />]\n    });\n    const [createReqBooking,  { loading, error, data }] = useMutation(BOOKING_REQ);\n\n    const inputDescription = useRef(null);\n\n    console.log(\"JOIN SEND RERENDER\")\n    useEffect(() => {\n\n      event && event.bookings && event.bookings.map(item => {\n        if( item.user._id === localContext._id) {\n            if(item.decided && item.confirmed){\n                // attending = true\n                // icon = [<DoneIcon fontSize=\"large\" />]\n                setLocalState(prev => {\n                  {\n                    return { \n                      ...prev, \n                      message: \"Attending\",\n                    attending: true,\n                    icon: [<DoneIcon fontSize=\"large\" />]\n                   };\n                  }\n                })\n            }\n        }\n    })\n\n    }, [event, event.bookings, localContext._id])\n\n    function openJoin(){\n      if(!localState.attending && !localState.pending){\n        setChecked(true)\n        setTimeout(() => { \n          window.scrollBy({\n          top: 200,\n          left: 0,\n          behavior: 'smooth'\n        }); }, 100);\n        setTimeout(() => { \n          document.getElementById(\"bottomAnchor\").scrollIntoView();\n        }, 400);\n      }\n    }\n\n    function sendBooking(params) {\n      setLocalState(prev => ({ \n            ...prev, \n            message: \"Sending\",\n            attending: true,\n            icon: [<HourglassEmptyIcon fontSize=\"large\" />]\n      }))\n        createReqBooking({\n            variables: {\n              guest_id: localContext._id,\n              guest_name: localContext.name,\n              event_id: event._id,\n              message: inputDescription.current.value\n                        ? inputDescription.current.value\n                        : null,\n            },\n            refetchQueries: () => [\n              {\n                query: PROFILE_DATA,\n                variables: { host_id: localContext._id }\n              },\n              {\n                query: GET_ONE_EVENT,\n                variables: { event_id: history.location.pathname.split(\"/\")[2]}\n              },\n              {\n                query: EVENT_BOOKINGS,\n                variables: { event_id: event._id }\n              },\n              {\n                query: PLAY_EVENTS_QUERY,\n                variables: {\n                  plusDays: localContext.filterOn ? localContext.plusDays : 10000,\n                  lng: localContext.geolocationObj ? localContext.geolocationObj.lng : null,\n                  lat: localContext.geolocationObj ? localContext.geolocationObj.lat : null,\n                  radius: localContext.filterOn ? localContext.radius : 9999999,\n                  shownEvents: localContext.shownEvents\n                }\n              }\n            ]\n          })\n          setChecked(false)\n    }\n\n    if(event.areYouAuthor) return <p className={classes.textAuthor}> You are author of this event </p>\n\n    return (\n        <>\n        <Chip \n        label={`${localState.message}`} \n        // icon={attending && <DoneIcon fontSize=\"large\" />}\n        icon={localState.icon[0]}\n        //variant=\"outlined\" \n        color=\"secondary\" \n        className={classes.chipOne} \n        onClick={openJoin}\n        disabled={checked || localState.attending || localState.pending}\n        />\n        <Grid container\n            className={clsx(classes.sendJoinContainer, checked && classes.openSend, )}\n            alignItems=\"center\">\n            {!loading && !data && (\n            <Grid item xs={12} className={clsx(classes.itemSend, checked && classes.displayBlock)}>\n            <Animated\n              animationIn=\"fadeIn\"\n              animationOut=\"fadeOut\"\n              animationInDelay={500}\n              //animationInDuration={5000}\n              isVisible={true}\n              infinite={true}\n            >\n                <InputLabel htmlFor=\"standard-adornment-amount\">\n                    YOUR MESSAGE\n                </InputLabel>\n                <TextField\n                    variant=\"outlined\"\n                    margin=\"normal\"\n                    required\n                    fullWidth\n                    defaultValue=\"Hi, let me please come and pay you money :)\"\n                    multiline\n                    rows=\"4\"\n                    color=\"primary\"\n                    inputRef={inputDescription}\n                    name=\"decsription\"\n                    autoComplete=\"false\"\n                    className={classes.textField}\n                    />\n                    <Chip label={`SEND`} \n                        color=\"secondary\" \n                        icon={<SendIcon fontSize=\"large\" />}\n                        className={classes.chipSend}\n                        onClick={sendBooking}\n                        />\n                </Animated>\n                <div id=\"bottomAnchor\"></div>\n            </Grid>\n            )}\n            {loading && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                  <Spinner height={100} width={100} />\n                </Grid>\n              </Grid>\n            )}\n            \n            {!loading && data && data.requestBookEvent && (\n            <Grid item xs={12} className={clsx(classes.itemSend, checked && classes.displayBlock)}>\n                <InputLabel htmlFor=\"standard-adornment-amount\">\n                    Finished\n                </InputLabel>\n                \n            </Grid>\n            )}\n        </Grid>\n    </>\n    )\n}\n\n\nconst useStyles = makeStyles(theme => ({\n   \n    sendJoinContainer: {\n      backgroundColor: \"white\",\n      height: 0,\n      overflow: 'hidden',\n      transition: 'height 0.6s',\n      transitionTimingFunction: 'ease-out',\n    },\n    openSend: {\n      display: \"block\",\n      height: 248,\n      padding: 10,\n    },\n    textAuthor:{\n      textAlign: \"center\"\n    },\n    itemSend: {\n        display: \"none\",\n      },\n    displayBlock: {\n        display: \"block\",\n      },\n    chipOne: {\n      width: \"90%\", \n      fontWeight: 500, \n      fontSize: 25, \n      padding: 20, \n      margin: \"5%\"\n      },\n    chipSend: {\n      width: \"90%\", \n      fontWeight: 500, \n      fontSize: 25, \n      padding: 20, \n      margin: \"5%\" \n    }\n  \n  }));"]},"metadata":{},"sourceType":"module"}