{"ast":null,"code":"import _toConsumableArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useState,useContext,useEffect}from\"react\";import Container from\"@material-ui/core/Container\";import Grid from\"@material-ui/core/Grid\";import ArrowDownwardIcon from'@material-ui/icons/ArrowDownward';import{makeStyles,useTheme}from\"@material-ui/core/styles\";import{useMutation,useQuery}from\"@apollo/react-hooks\";import{useHistory,NavLink}from\"react-router-dom\";import{UserContext}from\"../userContext\";// import { useWindowSize } from \"../Hooks/useWindowSize\";\nimport Spinner from\"src/Atoms/Spinner\";import SettingsPanel2 from\"src/Molecules/play/SettingsPanel\";import PlayPageGallery from\"src/Molecules/play/PlayPageGallery\";import PlayPageList from\"src/Molecules/play/PlayPageList\";import PlayPageMap from\"src/Molecules/play/PlayPageMap\";import NoLocationBck from\"src/Molecules/play/NoLocationBck\";import LoginFirstBoard from\"src/Atoms/LoginFirstBoard\";import NoEventsBoard from\"src/Atoms/NoEventsBoard\";import EventButtons from\"src/Molecules/event/EventButtons\";import{PLAY_EVENTS}from\"src/Services/GQL/PLAY_EVENTS\";import{PLAY_EVENTS_QUERY}from\"src/Services/GQL/PLAY_EVENTS_QUERY\";function Play(){var classes=useStyles();var history=useHistory();var _useContext=useContext(UserContext),context=_useContext.context,setContext=_useContext.setContext;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loadingPlay=_useState2[0],setLoadingPlay=_useState2[1];var _useQuery=useQuery(PLAY_EVENTS_QUERY,{variables:{plusDays:context.playFilterObj.filterOn?context.playFilterObj.plusDays:10000,lng:context.playFilterObj.geolocationPlay?context.playFilterObj.geolocationPlay.lng:null,lat:context.playFilterObj.geolocationPlay?context.playFilterObj.geolocationPlay.lat:null,radius:context.playFilterObj.filterOn?context.playFilterObj.radius:9999999,shownEvents:context.playFilterObj.shownEvents}}),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data,refetch=_useQuery.refetch;useEffect(function(){window.scrollTo(0,0);},[context.playFilterObj]);useEffect(function(){return function(){console.log(\"Going out of Play\");setContext(function(prev){return _objectSpread({},prev,{playFilterObj:_objectSpread({},prev.playFilterObj,{shownEvents:[]})});});};},[]);useEffect(function(){if(data&&data.getJoinEvents){if(context.playFilterObj.shownEvents.length===0){// context.playEventsCount === null\nconsole.log(\"Pass if null\");setContext(function(prev){return _objectSpread({},prev,{playFilterObj:_objectSpread({},prev.playFilterObj,{playEventsCount:data.getJoinEvents.length})});});}}},[data]);useEffect(function(){if(data&&data.getJoinEvents[0]){history.replace(\"/play/\".concat(data.getJoinEvents[0]._id));}window.scrollTo(0,0);},[data,data&&data.getJoinEvents[0]]);function discoverPlay(){setLoadingPlay(true);setTimeout(function(){// setDiscovered(discovered + 1)\nsetContext(function(prev){return _objectSpread({},prev,{playFilterObj:_objectSpread({},prev.playFilterObj,{shownEvents:[].concat(_toConsumableArray(prev.playFilterObj.shownEvents),[data.getJoinEvents[0]._id])})});});window.scrollTo(0,0);setLoadingPlay(false);},500);}return React.createElement(\"div\",{className:classes.playWrap,style:{position:context.freezScroll?\"fixed\":\"absolute\",color:\"white\"}},React.createElement(Container,{maxWidth:\"xs\"},React.createElement(SettingsPanel2//getPlayEventsMutation={getPlayEventsMutation} \n,{loading:loading})),React.createElement(Container,{maxWidth:\"xs\",className:classes.playContainer},context.name&&!context.playFilterObj.geolocationPlay&&React.createElement(NoLocationBck,null),loading&&React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",className:classes.loadingGridCont},React.createElement(Grid,{item:true},React.createElement(Spinner,{height:100,width:100}))),!context.name&&React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",className:classes.loadingGridCont},React.createElement(Grid,{item:true},React.createElement(LoginFirstBoard,null))),data&&data.getJoinEvents&&data.getJoinEvents.length===0&&React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",className:classes.loadingGridCont},React.createElement(Grid,{item:true},React.createElement(NoEventsBoard,null))),data&&data.getJoinEvents&&data.getJoinEvents.length!=0&&React.createElement(Grid,{container:true,justify:\"center\",direction:\"column\",alignItems:\"center\",alignContent:\"center\",style:{width:\"100%\"}},React.createElement(\"div\",{style:{width:\"100%\",display:\"block\",marginTop:110}},React.createElement(PlayPageGallery,{event:data.getJoinEvents[0]}),React.createElement(PlayPageList,{event:data.getJoinEvents[0],bookings:data.getJoinEvents[0].bookings,showBookings:data.getJoinEvents[0].bookings//showBookings\n// bookingStates={bookingStates}\n}),React.createElement(PlayPageMap,{event:data.getJoinEvents[0],showBookings:data.getJoinEvents.bookings//showBookings\n}),React.createElement(Grid,{container:true,className:classes.nextEventBox,alignItems:\"center\"},React.createElement(Grid,{item:true,xs:12},React.createElement(EventButtons,{event:data.getJoinEvents[0]}))),React.createElement(Grid,{container:true,className:classes.nextEventBox,justify:\"center\"},React.createElement(Grid,{item:true,xs:12,style:{margin:\"30px\"}},React.createElement(Grid,{container:true,justify:\"center\"},!loadingPlay&&data.getJoinEvents.length>=0&&React.createElement(Grid,{item:true,onClick:discoverPlay},React.createElement(ArrowDownwardIcon,{color:\"secondary\",style:{fontSize:100}})),loadingPlay&&React.createElement(Grid,{item:true},React.createElement(Spinner,{height:100,width:100})))))))));}var useStyles=makeStyles(function(theme){return{playWrap:{width:'100%',top:0,minHeight:\"100%\",background:\"linear-gradient(90deg, #311F26 30%, #90053B 100%)\"},playContainer:{padding:0},loadingGridCont:{minHeight:\"100vh\"},paper:{width:\"100%\",minHeight:\"100%\",paddingTop:10,display:\"flex\",flexDirection:\"column\",alignItems:\"center\",// backgroundColor: \"#242323\",\nbackground:\"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",color:\"white\"},mainHeader:{marginTop:'30px',marginBottom:'10px'},mainGalleryFake:{backgroundColor:\"#2F2F2F\",height:\"60px\",width:\"100%\"},nextEventBox:{width:\"100%\",backgroundColor:\"transparent\",paddingTop:20,paddingBottom:20},light:{backgroundColor:\"lightgrey\"},thisLine:{height:'1px',width:'100%',marginTop:'2px',backgroundColor:\"#707070\"}};});export default Play;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Play.js"],"names":["React","useState","useContext","useEffect","Container","Grid","ArrowDownwardIcon","makeStyles","useTheme","useMutation","useQuery","useHistory","NavLink","UserContext","Spinner","SettingsPanel2","PlayPageGallery","PlayPageList","PlayPageMap","NoLocationBck","LoginFirstBoard","NoEventsBoard","EventButtons","PLAY_EVENTS","PLAY_EVENTS_QUERY","Play","classes","useStyles","history","context","setContext","loadingPlay","setLoadingPlay","variables","plusDays","playFilterObj","filterOn","lng","geolocationPlay","lat","radius","shownEvents","loading","error","data","refetch","window","scrollTo","console","log","prev","getJoinEvents","length","playEventsCount","replace","_id","discoverPlay","setTimeout","playWrap","position","freezScroll","color","playContainer","name","loadingGridCont","width","display","marginTop","bookings","nextEventBox","margin","fontSize","theme","top","minHeight","background","padding","paper","paddingTop","flexDirection","alignItems","mainHeader","marginBottom","mainGalleryFake","backgroundColor","height","paddingBottom","light","thisLine"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\n\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\n\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\n\nimport { useHistory, NavLink } from \"react-router-dom\";\n\nimport { UserContext } from \"../userContext\";\n// import { useWindowSize } from \"../Hooks/useWindowSize\";\n\nimport Spinner from \"src/Atoms/Spinner\";\n\nimport SettingsPanel2 from \"src/Molecules/play/SettingsPanel\";\n\nimport PlayPageGallery from \"src/Molecules/play/PlayPageGallery\";\nimport PlayPageList from \"src/Molecules/play/PlayPageList\";\nimport PlayPageMap from \"src/Molecules/play/PlayPageMap\";\nimport NoLocationBck from \"src/Molecules/play/NoLocationBck\";\nimport LoginFirstBoard from \"src/Atoms/LoginFirstBoard\";\nimport NoEventsBoard from \"src/Atoms/NoEventsBoard\";\nimport EventButtons from \"src/Molecules/event/EventButtons\";\n\nimport { PLAY_EVENTS } from \"src/Services/GQL/PLAY_EVENTS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nfunction Play() {\n  const classes = useStyles();\n  let history = useHistory();\n  const { context, setContext } = useContext(UserContext);\n  const [loadingPlay, setLoadingPlay] = useState(false);\n\n  const { loading, error, data, refetch } = useQuery(PLAY_EVENTS_QUERY, {\n    variables: {\n      plusDays: context.playFilterObj.filterOn ? context.playFilterObj.plusDays : 10000,\n      lng: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lng : null,\n      lat: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lat : null,\n      radius: context.playFilterObj.filterOn ? context.playFilterObj.radius : 9999999,\n      shownEvents: context.playFilterObj.shownEvents\n    }\n  });\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [context.playFilterObj]);\n\n\n  useEffect(() => {\n\n    return (() => {\n      console.log(\"Going out of Play\")\n        setContext(prev => {return {\n          ...prev, \n          playFilterObj: {\n            ...prev.playFilterObj,\n            shownEvents: []\n          }\n        }});\n    })\n  },[])\n\n\n\n\n  useEffect(() => {\n    if(data && data.getJoinEvents){\n      if(context.playFilterObj.shownEvents.length === 0){ // context.playEventsCount === null\n        console.log(\"Pass if null\")\n        setContext(prev => {return {\n          ...prev, \n          playFilterObj: {\n            ...prev.playFilterObj,\n            playEventsCount: data.getJoinEvents.length\n          }\n          }});\n      }\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if(data && data.getJoinEvents[0]){history.replace(`/play/${data.getJoinEvents[0]._id}`)} \n    window.scrollTo(0, 0);\n  }, [data, data && data.getJoinEvents[0]]);\n\n  function discoverPlay(){\n    setLoadingPlay(true)\n    setTimeout(() => {\n      // setDiscovered(discovered + 1)\n      setContext(prev => {\n        return {\n          ...prev, \n          playFilterObj: {\n            ...prev.playFilterObj,\n          shownEvents: [...prev.playFilterObj.shownEvents, data.getJoinEvents[0]._id]\n        }\n      }});\n      window.scrollTo(0,0);\n      setLoadingPlay(false)\n    }, 500)\n  }\n\n  \n  return (\n    <div\n      className={classes.playWrap}\n      style={{ position: context.freezScroll ? \"fixed\" : \"absolute\", color: \"white\" }}\n    >\n    <Container maxWidth=\"xs\">\n\n      <SettingsPanel2  //getPlayEventsMutation={getPlayEventsMutation} \n        loading={loading}\n          />\n    </Container>\n\n    <Container\n      maxWidth=\"xs\"\n      className={classes.playContainer}\n    >\n        {context.name && !context.playFilterObj.geolocationPlay &&\n        <NoLocationBck />}\n\n            {loading && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                  <Spinner height={100} width={100} />\n                </Grid>\n              </Grid>\n            )}\n            {!context.name && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <LoginFirstBoard />\n                </Grid>\n              </Grid>\n            )}\n\n            {data && data.getJoinEvents && data.getJoinEvents.length === 0 && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <NoEventsBoard />\n                </Grid>\n              </Grid>\n            )}\n            {data && data.getJoinEvents && data.getJoinEvents.length != 0 && (\n            <Grid\n              container\n              justify=\"center\"\n              direction=\"column\"\n              alignItems=\"center\"\n              alignContent=\"center\"\n              style={{ width: \"100%\" }}\n            >\n              <div style={{width: \"100%\", display: \"block\", marginTop: 110}}>\n\n                  <PlayPageGallery event={data.getJoinEvents[0]} />\n                  <PlayPageList\n                    event={data.getJoinEvents[0]}\n                    bookings={data.getJoinEvents[0].bookings}\n                    showBookings={data.getJoinEvents[0].bookings} //showBookings\n                    // bookingStates={bookingStates}\n                  />\n                  <PlayPageMap\n                    event={data.getJoinEvents[0]}\n                    showBookings={data.getJoinEvents.bookings} //showBookings\n                  /> \n                   \n                  <Grid container\n                        className={classes.nextEventBox}\n                        alignItems=\"center\">\n                    <Grid item xs={12}>\n                        {/* <JoinSend event={getJoinEvents[0]} getPlayEventsMutation={getPlayEventsMutation} /> */}\n                        <EventButtons event={data.getJoinEvents[0]} />\n                    </Grid>\n                  </Grid>\n                  <Grid container\n                    className={classes.nextEventBox}\n                    justify=\"center\">\n                      <Grid item xs={12} style={{ margin: \"30px\"}}>\n                          <Grid container justify=\"center\">\n                              {!loadingPlay && data.getJoinEvents.length >= 0 &&\n                                  <Grid item onClick={discoverPlay}>\n                                    <ArrowDownwardIcon color=\"secondary\" style={{ fontSize: 100 }} />\n                                  </Grid>\n                              }\n                              {loadingPlay && <Grid item><Spinner height={100} width={100} /></Grid>}\n                          </Grid>\n                        </Grid>\n                  </Grid>\n              </div>\n            </Grid>\n\n            )}\n  \n    </Container>\n    </div>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  playWrap: {\n    width: '100%',\n    top: 0,\n    minHeight: \"100%\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n  },\n  playContainer: {\n    padding: 0,\n  },\n  loadingGridCont: {\n    minHeight: \"100vh\",\n  },\n  paper: {\n    width: \"100%\",\n    minHeight: \"100%\",\n    paddingTop: 10,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    // backgroundColor: \"#242323\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n    color: \"white\"\n  },\n  mainHeader:{\n    marginTop: '30px',\n    marginBottom: '10px'\n  },\n  mainGalleryFake: {\n    backgroundColor: \"#2F2F2F\",\n    height: \"60px\",\n    width: \"100%\",\n  },\n  nextEventBox: {\n    width: \"100%\",\n    backgroundColor: \"transparent\",\n    paddingTop: 20,\n    paddingBottom: 20,\n  },\n  light: {\n    backgroundColor: \"lightgrey\"\n  },\n\n  thisLine:{\n    height: '1px',\n    width: '100%',\n    marginTop: '2px',\n    backgroundColor: \"#707070\"\n  },\n\n}));\n\nexport default Play;\n"]},"metadata":{},"sourceType":"module"}