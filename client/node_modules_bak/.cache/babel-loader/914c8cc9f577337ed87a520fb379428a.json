{"ast":null,"code":"import _defineProperty from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Play.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport { useHistory, NavLink } from \"react-router-dom\";\nimport { UserContext } from \"../userContext\"; // import { useWindowSize } from \"../Hooks/useWindowSize\";\n\nimport Spinner from \"src/Atoms/Spinner\";\nimport SettingsPanel2 from \"src/Molecules/play/SettingsPanel2\";\nimport PlayPageGallery from \"src/Molecules/play/PlayPageGallery\";\nimport PlayPageList from \"src/Molecules/play/PlayPageList\";\nimport PlayPageMap from \"src/Molecules/play/PlayPageMap\";\nimport NoLocationBck from \"src/Molecules/play/NoLocationBck\";\nimport LoginFirstBoard from \"src/Atoms/LoginFirstBoard\";\nimport NoEventsBoard from \"src/Atoms/NoEventsBoard\";\nimport EventButtons from \"src/Molecules/event/EventButtons\";\nimport { PLAY_EVENTS } from \"src/Services/GQL/PLAY_EVENTS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nfunction Play() {\n  const classes = useStyles();\n  let history = useHistory();\n\n  const _useContext = useContext(UserContext),\n        context = _useContext.context,\n        setContext = _useContext.setContext;\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        loadingPlay = _useState2[0],\n        setLoadingPlay = _useState2[1];\n\n  const _useQuery = useQuery(PLAY_EVENTS_QUERY, {\n    variables: {\n      plusDays: context.filterOn ? context.days : 10000,\n      lng: context.geolocationObj ? context.geolocationObj.lng : null,\n      lat: context.geolocationObj ? context.geolocationObj.lat : null,\n      radius: context.filterOn ? context.radius : 9999999,\n      shownEvents: context.shownEvents\n    }\n  }),\n        loading = _useQuery.loading,\n        error = _useQuery.error,\n        data = _useQuery.data,\n        refetch = _useQuery.refetch;\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [context]);\n  useEffect(() => {\n    if (!context.geolocationObj) {\n      navigator.geolocation.getCurrentPosition(function (position) {\n        setContext(prev => {\n          return _objectSpread({}, prev, {\n            geolocationObj: {\n              lat: position.coords.latitude,\n              lng: position.coords.longitude\n            }\n          });\n        });\n      });\n    }\n\n    return function cleanup() {\n      setContext(prev => {\n        return _objectSpread({}, prev, {\n          shownEvents: []\n        });\n      });\n    };\n  }, [context.geolocationObj]);\n  useEffect(() => {\n    if (data && data.getJoinEvents) {\n      if (context.shownEvents.length === 0) {\n        // context.playEventsCount === null\n        console.log(\"Pass if null\");\n        setContext(prev => {\n          return _objectSpread({}, prev, {\n            playEventsCount: data.getJoinEvents.length\n          });\n        });\n      }\n    }\n  }, [data]);\n  useEffect(() => {\n    if (data && data.getJoinEvents[0]) {\n      history.replace(\"/play/\".concat(data.getJoinEvents[0]._id));\n    }\n\n    window.scrollTo(0, 0);\n  }, [data, data && data.getJoinEvents[0]]);\n\n  function discoverPlay() {\n    setLoadingPlay(true);\n    setTimeout(() => {\n      // setDiscovered(discovered + 1)\n      setContext(prev => {\n        return _objectSpread({}, prev, {\n          shownEvents: [...prev.shownEvents, data.getJoinEvents[0]._id]\n        });\n      });\n      window.scrollTo(0, 0);\n      setLoadingPlay(false);\n    }, 500);\n  }\n\n  return React.createElement(\"div\", {\n    className: classes.playWrap,\n    style: {\n      position: context.freezScroll ? \"fixed\" : \"absolute\",\n      color: \"white\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, React.createElement(Container, {\n    maxWidth: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(SettingsPanel2 //getPlayEventsMutation={getPlayEventsMutation} \n  , {\n    loading: loading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  })), React.createElement(Container, {\n    maxWidth: \"xs\",\n    className: classes.playContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, context.name && !context.geolocationObj && React.createElement(NoLocationBck, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }), loading && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    height: 100,\n    width: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }))), !context.name && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(LoginFirstBoard, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }))), data && data.getJoinEvents && data.getJoinEvents.length === 0 && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, React.createElement(NoEventsBoard, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }))), data && data.getJoinEvents && data.getJoinEvents.length != 0 && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    direction: \"column\",\n    alignItems: \"center\",\n    alignContent: \"center\",\n    style: {\n      width: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      width: \"100%\",\n      display: \"block\",\n      marginTop: 80\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(PlayPageGallery, {\n    event: data.getJoinEvents[0],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }), React.createElement(PlayPageList, {\n    event: data.getJoinEvents[0],\n    bookings: data.getJoinEvents[0].bookings,\n    showBookings: data.getJoinEvents[0].bookings //showBookings\n    // bookingStates={bookingStates}\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }), React.createElement(PlayPageMap, {\n    event: data.getJoinEvents[0],\n    showBookings: data.getJoinEvents.bookings //showBookings\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), React.createElement(Grid, {\n    container: true,\n    className: classes.nextEventBox,\n    alignItems: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(EventButtons, {\n    event: data.getJoinEvents[0],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }))), React.createElement(Grid, {\n    container: true,\n    className: classes.nextEventBox,\n    justify: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    style: {\n      margin: \"30px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, !loadingPlay && data.getJoinEvents.length >= 0 && React.createElement(Grid, {\n    item: true,\n    onClick: discoverPlay,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(ArrowDownwardIcon, {\n    color: \"secondary\",\n    style: {\n      fontSize: 100\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  })), loadingPlay && React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    height: 100,\n    width: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  })))))))));\n}\n\nconst useStyles = makeStyles(theme => ({\n  playWrap: {\n    width: '100%',\n    top: 0,\n    minHeight: \"100%\",\n    background: \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\"\n  },\n  playContainer: {\n    padding: 0\n  },\n  loadingGridCont: {\n    minHeight: \"100vh\"\n  },\n  paper: {\n    width: \"100%\",\n    minHeight: \"100%\",\n    paddingTop: 10,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    // backgroundColor: \"#242323\",\n    background: \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n    color: \"white\"\n  },\n  mainHeader: {\n    marginTop: '30px',\n    marginBottom: '10px'\n  },\n  mainGalleryFake: {\n    backgroundColor: \"#2F2F2F\",\n    height: \"60px\",\n    width: \"100%\"\n  },\n  nextEventBox: {\n    width: \"100%\",\n    backgroundColor: \"transparent\",\n    paddingTop: 20,\n    paddingBottom: 20\n  },\n  light: {\n    backgroundColor: \"lightgrey\"\n  },\n  thisLine: {\n    height: '1px',\n    width: '100%',\n    marginTop: '2px',\n    backgroundColor: \"#707070\"\n  }\n}));\nexport default Play;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Play.js"],"names":["React","useState","useContext","useEffect","Container","Grid","ArrowDownwardIcon","makeStyles","useTheme","useMutation","useQuery","useHistory","NavLink","UserContext","Spinner","SettingsPanel2","PlayPageGallery","PlayPageList","PlayPageMap","NoLocationBck","LoginFirstBoard","NoEventsBoard","EventButtons","PLAY_EVENTS","PLAY_EVENTS_QUERY","Play","classes","useStyles","history","context","setContext","loadingPlay","setLoadingPlay","variables","plusDays","filterOn","days","lng","geolocationObj","lat","radius","shownEvents","loading","error","data","refetch","window","scrollTo","navigator","geolocation","getCurrentPosition","position","prev","coords","latitude","longitude","cleanup","getJoinEvents","length","console","log","playEventsCount","replace","_id","discoverPlay","setTimeout","playWrap","freezScroll","color","playContainer","name","loadingGridCont","width","display","marginTop","bookings","nextEventBox","margin","fontSize","theme","top","minHeight","background","padding","paper","paddingTop","flexDirection","alignItems","mainHeader","marginBottom","mainGalleryFake","backgroundColor","height","paddingBottom","light","thisLine"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\n\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\n\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\n\nimport { useHistory, NavLink } from \"react-router-dom\";\n\nimport { UserContext } from \"../userContext\";\n// import { useWindowSize } from \"../Hooks/useWindowSize\";\n\nimport Spinner from \"src/Atoms/Spinner\";\n\nimport SettingsPanel2 from \"src/Molecules/play/SettingsPanel2\";\n\nimport PlayPageGallery from \"src/Molecules/play/PlayPageGallery\";\nimport PlayPageList from \"src/Molecules/play/PlayPageList\";\nimport PlayPageMap from \"src/Molecules/play/PlayPageMap\";\nimport NoLocationBck from \"src/Molecules/play/NoLocationBck\";\nimport LoginFirstBoard from \"src/Atoms/LoginFirstBoard\";\nimport NoEventsBoard from \"src/Atoms/NoEventsBoard\";\nimport EventButtons from \"src/Molecules/event/EventButtons\";\n\nimport { PLAY_EVENTS } from \"src/Services/GQL/PLAY_EVENTS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nfunction Play() {\n  const classes = useStyles();\n  let history = useHistory();\n  const { context, setContext } = useContext(UserContext);\n  const [loadingPlay, setLoadingPlay] = useState(false);\n\n  const { loading, error, data, refetch } = useQuery(PLAY_EVENTS_QUERY, {\n    variables: {\n      plusDays: context.filterOn ? context.days : 10000,\n      lng: context.geolocationObj ? context.geolocationObj.lng : null,\n      lat: context.geolocationObj ? context.geolocationObj.lat : null,\n      radius: context.filterOn ? context.radius : 9999999,\n      shownEvents: context.shownEvents\n    }\n  });\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [context]);\n\n  useEffect(() => {\n    if(!context.geolocationObj){\n      navigator.geolocation.getCurrentPosition(function(position) {\n        setContext(prev => {return {...prev, geolocationObj: {lat: position.coords.latitude, lng: position.coords.longitude}}});\n    });\n    }\n    return function cleanup() {\n      setContext(prev => {return {...prev, shownEvents: []}});\n    };\n  }, [context.geolocationObj]);\n\n\n\n\n\n  useEffect(() => {\n    if(data && data.getJoinEvents){\n      if(context.shownEvents.length === 0){ // context.playEventsCount === null\n        console.log(\"Pass if null\")\n        setContext(prev => {return {...prev, playEventsCount: data.getJoinEvents.length}});\n      }\n    }\n  }, [data]);\n\n\n  useEffect(() => {\n    if(data && data.getJoinEvents[0]){history.replace(`/play/${data.getJoinEvents[0]._id}`)} \n    window.scrollTo(0, 0);\n  }, [data, data && data.getJoinEvents[0]]);\n\n  function discoverPlay(){\n    setLoadingPlay(true)\n    setTimeout(() => {\n      // setDiscovered(discovered + 1)\n      setContext(prev => {\n        return {...prev, shownEvents: [...prev.shownEvents, data.getJoinEvents[0]._id]}});\n      window.scrollTo(0,0);\n      setLoadingPlay(false)\n    }, 500)\n  }\n\n  \n  return (\n    <div\n      className={classes.playWrap}\n      style={{ position: context.freezScroll ? \"fixed\" : \"absolute\", color: \"white\" }}\n    >\n    <Container maxWidth=\"xs\">\n\n      <SettingsPanel2  //getPlayEventsMutation={getPlayEventsMutation} \n        loading={loading}\n          />\n    </Container>\n\n    <Container\n      maxWidth=\"xs\"\n      className={classes.playContainer}\n    >\n        {context.name && !context.geolocationObj &&\n        <NoLocationBck />}\n\n            {loading && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                  <Spinner height={100} width={100} />\n                </Grid>\n              </Grid>\n            )}\n            {!context.name && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <LoginFirstBoard />\n                </Grid>\n              </Grid>\n            )}\n\n            {data && data.getJoinEvents && data.getJoinEvents.length === 0 && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <NoEventsBoard />\n                </Grid>\n              </Grid>\n            )}\n            {data && data.getJoinEvents && data.getJoinEvents.length != 0 && (\n            <Grid\n              container\n              justify=\"center\"\n              direction=\"column\"\n              alignItems=\"center\"\n              alignContent=\"center\"\n              style={{ width: \"100%\" }}\n            >\n              <div style={{width: \"100%\", display: \"block\", marginTop: 80}}>\n\n                  <PlayPageGallery event={data.getJoinEvents[0]} />\n                  <PlayPageList\n                    event={data.getJoinEvents[0]}\n                    bookings={data.getJoinEvents[0].bookings}\n                    showBookings={data.getJoinEvents[0].bookings} //showBookings\n                    // bookingStates={bookingStates}\n                  />\n                  <PlayPageMap\n                    event={data.getJoinEvents[0]}\n                    showBookings={data.getJoinEvents.bookings} //showBookings\n                  /> \n                   \n                  <Grid container\n                        className={classes.nextEventBox}\n                        alignItems=\"center\">\n                    <Grid item xs={12}>\n                        {/* <JoinSend event={getJoinEvents[0]} getPlayEventsMutation={getPlayEventsMutation} /> */}\n                        <EventButtons event={data.getJoinEvents[0]} />\n                    </Grid>\n                  </Grid>\n                  <Grid container\n                    className={classes.nextEventBox}\n                    justify=\"center\">\n                      <Grid item xs={12} style={{ margin: \"30px\"}}>\n                          <Grid container justify=\"center\">\n                              {!loadingPlay && data.getJoinEvents.length >= 0 &&\n                                  <Grid item onClick={discoverPlay}>\n                                    <ArrowDownwardIcon color=\"secondary\" style={{ fontSize: 100 }} />\n                                  </Grid>\n                              }\n                              {loadingPlay && <Grid item><Spinner height={100} width={100} /></Grid>}\n                          </Grid>\n                        </Grid>\n                  </Grid>\n              </div>\n            </Grid>\n\n            )}\n  \n    </Container>\n    </div>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  playWrap: {\n    width: '100%',\n    top: 0,\n    minHeight: \"100%\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n  },\n  playContainer: {\n    padding: 0,\n  },\n  loadingGridCont: {\n    minHeight: \"100vh\",\n  },\n  paper: {\n    width: \"100%\",\n    minHeight: \"100%\",\n    paddingTop: 10,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    // backgroundColor: \"#242323\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n    color: \"white\"\n  },\n  mainHeader:{\n    marginTop: '30px',\n    marginBottom: '10px'\n  },\n  mainGalleryFake: {\n    backgroundColor: \"#2F2F2F\",\n    height: \"60px\",\n    width: \"100%\",\n  },\n  nextEventBox: {\n    width: \"100%\",\n    backgroundColor: \"transparent\",\n    paddingTop: 20,\n    paddingBottom: 20,\n  },\n  light: {\n    backgroundColor: \"lightgrey\"\n  },\n\n  thisLine:{\n    height: '1px',\n    width: '100%',\n    marginTop: '2px',\n    backgroundColor: \"#707070\"\n  },\n\n}));\n\nexport default Play;\n"]},"metadata":{},"sourceType":"module"}