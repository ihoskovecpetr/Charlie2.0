{"ast":null,"code":"import _defineProperty from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Play.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport { useHistory, NavLink } from \"react-router-dom\";\nimport { UserContext } from \"../userContext\"; // import { useWindowSize } from \"../Hooks/useWindowSize\";\n\nimport { usePosition } from \"src/Hooks/useGeolocation\";\nimport Spinner from \"src/Atoms/Spinner\";\nimport SettingsPanel2 from \"src/Molecules/play/SettingsPanel\";\nimport PlayPageGallery from \"src/Molecules/play/PlayPageGallery\";\nimport PlayPageList from \"src/Molecules/play/PlayPageList\";\nimport PlayPageMap from \"src/Molecules/play/PlayPageMap\";\nimport NoLocationBck from \"src/Molecules/play/NoLocationBck\";\nimport LoginFirstBoard from \"src/Atoms/LoginFirstBoard\";\nimport NoEventsBoard from \"src/Atoms/NoEventsBoard\";\nimport EventButtons from \"src/Molecules/event/EventButtons\";\nimport { PLAY_EVENTS } from \"src/Services/GQL/PLAY_EVENTS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nfunction Play() {\n  const classes = useStyles();\n  let history = useHistory();\n\n  const _useContext = useContext(UserContext),\n        context = _useContext.context,\n        setContext = _useContext.setContext;\n\n  const _usePosition = usePosition(),\n        latitude = _usePosition.latitude,\n        longitude = _usePosition.longitude,\n        address = _usePosition.address,\n        err = _usePosition.err;\n\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        loadingPlay = _useState2[0],\n        setLoadingPlay = _useState2[1];\n\n  const _useQuery = useQuery(PLAY_EVENTS_QUERY, {\n    variables: {\n      plusDays: context.playFilterObj.filterOn ? context.playFilterObj.plusDays : 10000,\n      lng: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lng : null,\n      lat: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lat : null,\n      radius: context.playFilterObj.filterOn ? context.playFilterObj.radius : 9999999,\n      shownEvents: context.playFilterObj.shownEvents\n    }\n  }),\n        loading = _useQuery.loading,\n        error = _useQuery.error,\n        data = _useQuery.data,\n        refetch = _useQuery.refetch;\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [context.playFilterObj]);\n  useEffect(() => {\n    if (!context.playFilterObj.geolocationPlay) {\n      console.log(\"Unreachable code\"); //   navigator.geolocation.getCurrentPosition(function(position) {\n      //     setContext(prev => {return {\n      //       ...prev, \n      //       playFilterObj: {\n      //         ...prev.playFilterObj,\n      //         geolocationPlay: {lat: position.coords.latitude, lng: position.coords.longitude}\n      //     } \n      //   }});\n      // });\n    }\n\n    return function cleanup() {\n      setContext(prev => {\n        return _objectSpread({}, prev, {\n          playFilterObj: _objectSpread({}, prev.playFilterObj, {\n            shownEvents: []\n          })\n        });\n      });\n    };\n  }, [context.playFilterObj.geolocationObj]);\n  useEffect(() => {\n    if (data && data.getJoinEvents) {\n      if (context.playFilterObj.shownEvents.length === 0) {\n        // context.playEventsCount === null\n        console.log(\"Pass if null\");\n        setContext(prev => {\n          return _objectSpread({}, prev, {\n            playFilterObj: _objectSpread({}, prev.playFilterObj, {\n              playEventsCount: data.getJoinEvents.length\n            })\n          });\n        });\n      }\n    }\n  }, [data]);\n  useEffect(() => {\n    if (data && data.getJoinEvents[0]) {\n      history.replace(\"/play/\".concat(data.getJoinEvents[0]._id));\n    }\n\n    window.scrollTo(0, 0);\n  }, [data, data && data.getJoinEvents[0]]);\n\n  function discoverPlay() {\n    setLoadingPlay(true);\n    setTimeout(() => {\n      // setDiscovered(discovered + 1)\n      setContext(prev => {\n        return _objectSpread({}, prev, {\n          playFilterObj: _objectSpread({}, prev.playFilterObj, {\n            shownEvents: [...prev.playFilterObj.shownEvents, data.getJoinEvents[0]._id]\n          })\n        });\n      });\n      window.scrollTo(0, 0);\n      setLoadingPlay(false);\n    }, 500);\n  }\n\n  return React.createElement(\"div\", {\n    className: classes.playWrap,\n    style: {\n      position: context.freezScroll ? \"fixed\" : \"absolute\",\n      color: \"white\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, React.createElement(Container, {\n    maxWidth: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(SettingsPanel2 //getPlayEventsMutation={getPlayEventsMutation} \n  , {\n    loading: loading,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  })), React.createElement(Container, {\n    maxWidth: \"xs\",\n    className: classes.playContainer,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, context.name && !context.playFilterObj.geolocationPlay && React.createElement(NoLocationBck, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), loading && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    height: 100,\n    width: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }))), !context.name && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(LoginFirstBoard, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }))), data && data.getJoinEvents && data.getJoinEvents.length === 0 && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    alignItems: \"center\",\n    className: classes.loadingGridCont,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(NoEventsBoard, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }))), data && data.getJoinEvents && data.getJoinEvents.length != 0 && React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    direction: \"column\",\n    alignItems: \"center\",\n    alignContent: \"center\",\n    style: {\n      width: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      width: \"100%\",\n      display: \"block\",\n      marginTop: 80\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, React.createElement(PlayPageGallery, {\n    event: data.getJoinEvents[0],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }), React.createElement(PlayPageList, {\n    event: data.getJoinEvents[0],\n    bookings: data.getJoinEvents[0].bookings,\n    showBookings: data.getJoinEvents[0].bookings //showBookings\n    // bookingStates={bookingStates}\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }), React.createElement(PlayPageMap, {\n    event: data.getJoinEvents[0],\n    showBookings: data.getJoinEvents.bookings //showBookings\n    ,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }), React.createElement(Grid, {\n    container: true,\n    className: classes.nextEventBox,\n    alignItems: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, React.createElement(EventButtons, {\n    event: data.getJoinEvents[0],\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }))), React.createElement(Grid, {\n    container: true,\n    className: classes.nextEventBox,\n    justify: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    style: {\n      margin: \"30px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    container: true,\n    justify: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, !loadingPlay && data.getJoinEvents.length >= 0 && React.createElement(Grid, {\n    item: true,\n    onClick: discoverPlay,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, React.createElement(ArrowDownwardIcon, {\n    color: \"secondary\",\n    style: {\n      fontSize: 100\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  })), loadingPlay && React.createElement(Grid, {\n    item: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(Spinner, {\n    height: 100,\n    width: 100,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  })))))))));\n}\n\nconst useStyles = makeStyles(theme => ({\n  playWrap: {\n    width: '100%',\n    top: 0,\n    minHeight: \"100%\",\n    background: \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\"\n  },\n  playContainer: {\n    padding: 0\n  },\n  loadingGridCont: {\n    minHeight: \"100vh\"\n  },\n  paper: {\n    width: \"100%\",\n    minHeight: \"100%\",\n    paddingTop: 10,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    // backgroundColor: \"#242323\",\n    background: \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n    color: \"white\"\n  },\n  mainHeader: {\n    marginTop: '30px',\n    marginBottom: '10px'\n  },\n  mainGalleryFake: {\n    backgroundColor: \"#2F2F2F\",\n    height: \"60px\",\n    width: \"100%\"\n  },\n  nextEventBox: {\n    width: \"100%\",\n    backgroundColor: \"transparent\",\n    paddingTop: 20,\n    paddingBottom: 20\n  },\n  light: {\n    backgroundColor: \"lightgrey\"\n  },\n  thisLine: {\n    height: '1px',\n    width: '100%',\n    marginTop: '2px',\n    backgroundColor: \"#707070\"\n  }\n}));\nexport default Play;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Play.js"],"names":["React","useState","useContext","useEffect","Container","Grid","ArrowDownwardIcon","makeStyles","useTheme","useMutation","useQuery","useHistory","NavLink","UserContext","usePosition","Spinner","SettingsPanel2","PlayPageGallery","PlayPageList","PlayPageMap","NoLocationBck","LoginFirstBoard","NoEventsBoard","EventButtons","PLAY_EVENTS","PLAY_EVENTS_QUERY","Play","classes","useStyles","history","context","setContext","latitude","longitude","address","err","loadingPlay","setLoadingPlay","variables","plusDays","playFilterObj","filterOn","lng","geolocationPlay","lat","radius","shownEvents","loading","error","data","refetch","window","scrollTo","console","log","cleanup","prev","geolocationObj","getJoinEvents","length","playEventsCount","replace","_id","discoverPlay","setTimeout","playWrap","position","freezScroll","color","playContainer","name","loadingGridCont","width","display","marginTop","bookings","nextEventBox","margin","fontSize","theme","top","minHeight","background","padding","paper","paddingTop","flexDirection","alignItems","mainHeader","marginBottom","mainGalleryFake","backgroundColor","height","paddingBottom","light","thisLine"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\n\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\n\nimport ArrowDownwardIcon from '@material-ui/icons/ArrowDownward';\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\n\nimport { useHistory, NavLink } from \"react-router-dom\";\n\nimport { UserContext } from \"../userContext\";\n// import { useWindowSize } from \"../Hooks/useWindowSize\";\nimport { usePosition } from \"src/Hooks/useGeolocation\";\n\nimport Spinner from \"src/Atoms/Spinner\";\n\nimport SettingsPanel2 from \"src/Molecules/play/SettingsPanel\";\n\nimport PlayPageGallery from \"src/Molecules/play/PlayPageGallery\";\nimport PlayPageList from \"src/Molecules/play/PlayPageList\";\nimport PlayPageMap from \"src/Molecules/play/PlayPageMap\";\nimport NoLocationBck from \"src/Molecules/play/NoLocationBck\";\nimport LoginFirstBoard from \"src/Atoms/LoginFirstBoard\";\nimport NoEventsBoard from \"src/Atoms/NoEventsBoard\";\nimport EventButtons from \"src/Molecules/event/EventButtons\";\n\nimport { PLAY_EVENTS } from \"src/Services/GQL/PLAY_EVENTS\";\nimport { PLAY_EVENTS_QUERY } from \"src/Services/GQL/PLAY_EVENTS_QUERY\";\n\nfunction Play() {\n  const classes = useStyles();\n  let history = useHistory();\n  const { context, setContext } = useContext(UserContext);\n  const { latitude, longitude, address, err } = usePosition();\n  const [loadingPlay, setLoadingPlay] = useState(false);\n\n  const { loading, error, data, refetch } = useQuery(PLAY_EVENTS_QUERY, {\n    variables: {\n      plusDays: context.playFilterObj.filterOn ? context.playFilterObj.plusDays : 10000,\n      lng: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lng : null,\n      lat: context.playFilterObj.geolocationPlay ? context.playFilterObj.geolocationPlay.lat : null,\n      radius: context.playFilterObj.filterOn ? context.playFilterObj.radius : 9999999,\n      shownEvents: context.playFilterObj.shownEvents\n    }\n  });\n\n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [context.playFilterObj]);\n\n  useEffect(() => {\n    if(!context.playFilterObj.geolocationPlay){\n      console.log(\"Unreachable code\")\n    //   navigator.geolocation.getCurrentPosition(function(position) {\n    //     setContext(prev => {return {\n    //       ...prev, \n    //       playFilterObj: {\n    //         ...prev.playFilterObj,\n    //         geolocationPlay: {lat: position.coords.latitude, lng: position.coords.longitude}\n    //     } \n    //   }});\n    // });\n    }\n    return function cleanup() {\n      setContext(prev => {return {\n        ...prev, \n        playFilterObj: {\n          ...prev.playFilterObj,\n          shownEvents: []\n        }\n      }});\n    };\n  }, [context.playFilterObj.geolocationObj]);\n\n\n\n\n\n  useEffect(() => {\n    if(data && data.getJoinEvents){\n      if(context.playFilterObj.shownEvents.length === 0){ // context.playEventsCount === null\n        console.log(\"Pass if null\")\n        setContext(prev => {return {\n          ...prev, \n          playFilterObj: {\n            ...prev.playFilterObj,\n            playEventsCount: data.getJoinEvents.length\n          }\n          }});\n      }\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if(data && data.getJoinEvents[0]){history.replace(`/play/${data.getJoinEvents[0]._id}`)} \n    window.scrollTo(0, 0);\n  }, [data, data && data.getJoinEvents[0]]);\n\n  function discoverPlay(){\n    setLoadingPlay(true)\n    setTimeout(() => {\n      // setDiscovered(discovered + 1)\n      setContext(prev => {\n        return {\n          ...prev, \n          playFilterObj: {\n            ...prev.playFilterObj,\n          shownEvents: [...prev.playFilterObj.shownEvents, data.getJoinEvents[0]._id]\n        }\n      }});\n      window.scrollTo(0,0);\n      setLoadingPlay(false)\n    }, 500)\n  }\n\n  \n  return (\n    <div\n      className={classes.playWrap}\n      style={{ position: context.freezScroll ? \"fixed\" : \"absolute\", color: \"white\" }}\n    >\n    <Container maxWidth=\"xs\">\n\n      <SettingsPanel2  //getPlayEventsMutation={getPlayEventsMutation} \n        loading={loading}\n          />\n    </Container>\n\n    <Container\n      maxWidth=\"xs\"\n      className={classes.playContainer}\n    >\n        {context.name && !context.playFilterObj.geolocationPlay &&\n        <NoLocationBck />}\n\n            {loading && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                  <Spinner height={100} width={100} />\n                </Grid>\n              </Grid>\n            )}\n            {!context.name && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <LoginFirstBoard />\n                </Grid>\n              </Grid>\n            )}\n\n            {data && data.getJoinEvents && data.getJoinEvents.length === 0 && (\n              <Grid container justify=\"center\" alignItems='center' className={classes.loadingGridCont}>\n                <Grid item>\n                <NoEventsBoard />\n                </Grid>\n              </Grid>\n            )}\n            {data && data.getJoinEvents && data.getJoinEvents.length != 0 && (\n            <Grid\n              container\n              justify=\"center\"\n              direction=\"column\"\n              alignItems=\"center\"\n              alignContent=\"center\"\n              style={{ width: \"100%\" }}\n            >\n              <div style={{width: \"100%\", display: \"block\", marginTop: 80}}>\n\n                  <PlayPageGallery event={data.getJoinEvents[0]} />\n                  <PlayPageList\n                    event={data.getJoinEvents[0]}\n                    bookings={data.getJoinEvents[0].bookings}\n                    showBookings={data.getJoinEvents[0].bookings} //showBookings\n                    // bookingStates={bookingStates}\n                  />\n                  <PlayPageMap\n                    event={data.getJoinEvents[0]}\n                    showBookings={data.getJoinEvents.bookings} //showBookings\n                  /> \n                   \n                  <Grid container\n                        className={classes.nextEventBox}\n                        alignItems=\"center\">\n                    <Grid item xs={12}>\n                        {/* <JoinSend event={getJoinEvents[0]} getPlayEventsMutation={getPlayEventsMutation} /> */}\n                        <EventButtons event={data.getJoinEvents[0]} />\n                    </Grid>\n                  </Grid>\n                  <Grid container\n                    className={classes.nextEventBox}\n                    justify=\"center\">\n                      <Grid item xs={12} style={{ margin: \"30px\"}}>\n                          <Grid container justify=\"center\">\n                              {!loadingPlay && data.getJoinEvents.length >= 0 &&\n                                  <Grid item onClick={discoverPlay}>\n                                    <ArrowDownwardIcon color=\"secondary\" style={{ fontSize: 100 }} />\n                                  </Grid>\n                              }\n                              {loadingPlay && <Grid item><Spinner height={100} width={100} /></Grid>}\n                          </Grid>\n                        </Grid>\n                  </Grid>\n              </div>\n            </Grid>\n\n            )}\n  \n    </Container>\n    </div>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  playWrap: {\n    width: '100%',\n    top: 0,\n    minHeight: \"100%\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n  },\n  playContainer: {\n    padding: 0,\n  },\n  loadingGridCont: {\n    minHeight: \"100vh\",\n  },\n  paper: {\n    width: \"100%\",\n    minHeight: \"100%\",\n    paddingTop: 10,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    // backgroundColor: \"#242323\",\n    background:\n    \"linear-gradient(90deg, #311F26 30%, #90053B 100%)\",\n    color: \"white\"\n  },\n  mainHeader:{\n    marginTop: '30px',\n    marginBottom: '10px'\n  },\n  mainGalleryFake: {\n    backgroundColor: \"#2F2F2F\",\n    height: \"60px\",\n    width: \"100%\",\n  },\n  nextEventBox: {\n    width: \"100%\",\n    backgroundColor: \"transparent\",\n    paddingTop: 20,\n    paddingBottom: 20,\n  },\n  light: {\n    backgroundColor: \"lightgrey\"\n  },\n\n  thisLine:{\n    height: '1px',\n    width: '100%',\n    marginTop: '2px',\n    backgroundColor: \"#707070\"\n  },\n\n}));\n\nexport default Play;\n"]},"metadata":{},"sourceType":"module"}