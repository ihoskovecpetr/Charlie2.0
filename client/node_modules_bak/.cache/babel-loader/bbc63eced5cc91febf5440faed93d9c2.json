{"ast":null,"code":"import _defineProperty from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useState,useCallback}from\"react\";import{useDropzone}from\"react-dropzone\";import Gallery from\"react-grid-gallery\";import request from\"superagent\";import WallpaperIcon from\"@material-ui/icons/Wallpaper\";import{makeStyles}from\"@material-ui/core/styles\";// import Spinner from \"src/Atoms/Spinner\";\n// const CLOUDINARY_UPLOAD_PRESET = \"simple-preset-1\";\nvar CLOUDINARY_UPLOAD_PRESET=\"simpl_pst\";// const CLOUDINARY_UPLOAD_URL =\n//   \"https://api.cloudinary.com/v1_1/party-images-app/upload\"; \nvar CLOUDINARY_UPLOAD_URL=\"https://api.cloudinary.com/v1_1/dkyt8girl/upload\";var smallfile;function MyDropzone(_ref){var setFormValue=_ref.setFormValue,setCountOfFiles=_ref.setCountOfFiles;var classes=useStyles();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isUploading=_useState2[0],setIsUploading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),uploadedFiles=_useState4[0],setUploadedFiles=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),display=_useState6[0],setDisplay=_useState6[1];var onDrop=useCallback(function(acceptedFiles){// Do something with the files\nsetIsUploading(true);var count=0;acceptedFiles.map(function(file){handleImageUpload(file);count=count+1;});setCountOfFiles(count);},[]);var _useDropzone=useDropzone({onDrop:onDrop}),getRootProps=_useDropzone.getRootProps,getInputProps=_useDropzone.getInputProps,isDragActive=_useDropzone.isDragActive;var handleImageUpload=function handleImageUpload(file){var width=350;var height=350;var fileName=file.name;var reader=new FileReader();reader.readAsDataURL(file);reader.onload=function(event){var img=document.createElement(\"img\");img.src=event.target.result;img.onload=function(){var elem=document.createElement(\"canvas\");elem.width=width;elem.height=height;var ctx=elem.getContext(\"2d\");// img.width and img.height will contain the original dimensions\nctx.drawImage(img,0,0,width,height);ctx.canvas.toBlob(function(blob){smallfile=new File([blob],fileName,{type:\"image/jpeg\",lastModified:Date.now()});uploadingOneImg(smallfile,file);},\"image/jpeg\",1);};reader.onerror=function(error){return console.log(error);};};};var uploadingOneImg=function uploadingOneImg(imgTumb,imgFull){var urlTumb;//var divider;\nvar upload=request.post(CLOUDINARY_UPLOAD_URL).field(\"upload_preset\",CLOUDINARY_UPLOAD_PRESET).field(\"file\",imgTumb);upload.end(function(err,response){if(err){console.error(err);window.alert(\"Problem with uploading your picture..\");}if(response.body.secure_url!==\"\"){urlTumb=response.body.secure_url;}var upload2=request.post(CLOUDINARY_UPLOAD_URL).field(\"upload_preset\",CLOUDINARY_UPLOAD_PRESET).field(\"file\",imgFull);upload2.end(function(err,response){if(err){window.alert(\"Problem with uploading your picture..\");}if(response.body.secure_url!==\"\"){var uplArr=uploadedFiles;uplArr.push({src:response.body.secure_url,thumbnail:urlTumb,thumbnailWidth:response.body.width,scaletwidth:100,thumbnailHeight:response.body.height,isSelected:false,caption:\"After Rain (Jeshu John - designerspics.com)\"});setUploadedFiles(_toConsumableArray(uplArr));setIsUploading(false);setDisplay(true);setFormValue(function(prevValues){return _objectSpread({},prevValues,{ImagesArr:uplArr});});}});});};return React.createElement(React.Fragment,null,React.createElement(\"div\",Object.assign({},getRootProps(),{style:{outline:\"none\",cursor:\"pointer\",border:\"1px dashed grey\"}}),React.createElement(\"input\",getInputProps()),isDragActive?React.createElement(React.Fragment,null,React.createElement(WallpaperIcon,{fontSize:\"large\",className:classes.uploadIcon})):React.createElement(React.Fragment,null,React.createElement(WallpaperIcon,{fontSize:\"large\",className:classes.uploadIcon})),display?React.createElement(Gallery,{images:uploadedFiles,rowHeight:100,display:display,backdropClosesModal:true}):React.createElement(\"span\",null,\" \"),display?React.createElement(\"span\",null,\" \"):React.createElement(Gallery,{images:uploadedFiles,rowHeight:100,display:display,backdropClosesModal:true})));}var useStyles=makeStyles(function(theme){return{uploadIcon:{margin:20,\"&:hover\":{cursor:\"pointer\"}}};});export default MyDropzone;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Molecules/Dropzone.js"],"names":["React","useState","useCallback","useDropzone","Gallery","request","WallpaperIcon","makeStyles","CLOUDINARY_UPLOAD_PRESET","CLOUDINARY_UPLOAD_URL","smallfile","MyDropzone","setFormValue","setCountOfFiles","classes","useStyles","isUploading","setIsUploading","uploadedFiles","setUploadedFiles","display","setDisplay","onDrop","acceptedFiles","count","map","file","handleImageUpload","getRootProps","getInputProps","isDragActive","width","height","fileName","name","reader","FileReader","readAsDataURL","onload","event","img","document","createElement","src","target","result","elem","ctx","getContext","drawImage","canvas","toBlob","blob","File","type","lastModified","Date","now","uploadingOneImg","onerror","error","console","log","imgTumb","imgFull","urlTumb","upload","post","field","end","err","response","window","alert","body","secure_url","upload2","uplArr","push","thumbnail","thumbnailWidth","scaletwidth","thumbnailHeight","isSelected","caption","prevValues","ImagesArr","outline","cursor","border","uploadIcon","theme","margin"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport Gallery from \"react-grid-gallery\";\nimport request from \"superagent\";\nimport WallpaperIcon from \"@material-ui/icons/Wallpaper\";\nimport { makeStyles } from \"@material-ui/core/styles\";\n\n// import Spinner from \"src/Atoms/Spinner\";\n\n// const CLOUDINARY_UPLOAD_PRESET = \"simple-preset-1\";\nconst CLOUDINARY_UPLOAD_PRESET = \"simpl_pst\"; \n// const CLOUDINARY_UPLOAD_URL =\n//   \"https://api.cloudinary.com/v1_1/party-images-app/upload\"; \nconst CLOUDINARY_UPLOAD_URL =\n  \"https://api.cloudinary.com/v1_1/dkyt8girl/upload\"; \nlet smallfile;\n\nfunction MyDropzone({setFormValue, setCountOfFiles}) {\n  const classes = useStyles();\n  const [isUploading, setIsUploading] = useState(false);\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [display, setDisplay] = useState(false);\n  const onDrop = useCallback(acceptedFiles => {\n    // Do something with the files\n\n    setIsUploading(true);\n  \n    let count = 0 \n    acceptedFiles.map(file => {\n      handleImageUpload(file);\n      count = count + 1\n    });\n    setCountOfFiles(count)\n  }, []);\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop });\n\n  const handleImageUpload = file => {\n    const width = 350;\n    const height = 350;\n    const fileName = file.name;\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = event => {\n      const img = document.createElement(\"img\");\n      img.src = event.target.result;\n\n      img.onload = () => {\n        const elem = document.createElement(\"canvas\");\n        elem.width = width;\n        elem.height = height;\n        const ctx = elem.getContext(\"2d\");\n        // img.width and img.height will contain the original dimensions\n        ctx.drawImage(img, 0, 0, width, height);\n        ctx.canvas.toBlob(\n          blob => {\n            smallfile = new File([blob], fileName, {\n              type: \"image/jpeg\",\n              lastModified: Date.now()\n            });\n            uploadingOneImg(smallfile, file);\n          },\n          \"image/jpeg\",\n          1\n        );\n      };\n      reader.onerror = error => console.log(error);\n    };\n  };\n\n  const uploadingOneImg = (imgTumb, imgFull) => {\n    var urlTumb;\n\n    //var divider;\n    var upload = request\n      .post(CLOUDINARY_UPLOAD_URL)\n      .field(\"upload_preset\", CLOUDINARY_UPLOAD_PRESET)\n      .field(\"file\", imgTumb);\n    upload.end((err, response) => {\n      if (err) {\n        console.error(err);\n        window.alert(\"Problem with uploading your picture..\");\n      }\n\n      if (response.body.secure_url !== \"\") {\n        urlTumb = response.body.secure_url;\n      }\n\n      var upload2 = request\n        .post(CLOUDINARY_UPLOAD_URL)\n        .field(\"upload_preset\", CLOUDINARY_UPLOAD_PRESET)\n        .field(\"file\", imgFull);\n      upload2.end((err, response) => {\n        if (err) {\n          window.alert(\"Problem with uploading your picture..\");\n        }\n        if (response.body.secure_url !== \"\") {\n          var uplArr = uploadedFiles;\n          uplArr.push({\n            src: response.body.secure_url,\n            thumbnail: urlTumb,\n            thumbnailWidth: response.body.width,\n            scaletwidth: 100,\n            thumbnailHeight: response.body.height,\n            isSelected: false,\n            caption: \"After Rain (Jeshu John - designerspics.com)\"\n          });\n\n          setUploadedFiles([...uplArr]);\n          setIsUploading(false);\n          setDisplay(true);\n          setFormValue(prevValues => {\n            return { ...prevValues, ImagesArr: uplArr };\n          });\n        }\n      });\n    });\n  };\n\n  return (\n    <>\n      <div\n        {...getRootProps()}\n        style={{\n          outline: \"none\",\n          cursor: \"pointer\",\n          border: \"1px dashed grey\"\n        }}\n      >\n        <input {...getInputProps()} />\n        {isDragActive ? (\n          <>\n            <WallpaperIcon fontSize=\"large\" className={classes.uploadIcon} />\n          </>\n        ) : (\n          <>\n            <WallpaperIcon fontSize=\"large\" className={classes.uploadIcon} />\n          </>\n        )}\n        {/* <p>Place HERE your pictures</p> */}\n\n        {/* {isUploading ? <Spinner height={100} width={100} /> : null} */}\n        {display ? (\n          <Gallery\n            images={uploadedFiles}\n            rowHeight={100}\n            display={display}\n            backdropClosesModal={true}\n          />\n        ) : (\n          <span> </span>\n        )}\n        {display ? (\n          <span> </span>\n        ) : (\n          <Gallery\n            images={uploadedFiles}\n            rowHeight={100}\n            display={display}\n            backdropClosesModal={true}\n          />\n        )}\n      </div>\n    </>\n  );\n}\n\nconst useStyles = makeStyles(theme => ({\n  uploadIcon: {\n    margin: 20,\n    \"&:hover\": {\n      cursor: \"pointer\"\n    }\n  }\n}));\n\nexport default MyDropzone;\n"]},"metadata":{},"sourceType":"module"}