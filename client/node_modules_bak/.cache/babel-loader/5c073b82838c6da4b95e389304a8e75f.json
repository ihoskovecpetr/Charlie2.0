{"ast":null,"code":"import _defineProperty from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  mutation login($email: String!, $password: String!) {\\n    login(email: $email, password: $password) {\\n      dataOut {\\n        _id\\n        success\\n        name\\n        email\\n        picture\\n        description\\n        token\\n      }\\n      errorOut {\\n        name\\n        message\\n      }\\n    }\\n  }\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useEffect,useContext}from\"react\";import Grid from\"@material-ui/core/Grid\";import Box from\"@material-ui/core/Box\";import Paper from\"@material-ui/core/Paper\";import Avatar from\"@material-ui/core/Avatar\";import Alert from\"@material-ui/lab/Alert\";import Button from\"@material-ui/core/Button\";import TextField from\"@material-ui/core/TextField\";import FormControlLabel from\"@material-ui/core/FormControlLabel\";import Checkbox from\"@material-ui/core/Checkbox\";import Link from\"@material-ui/core/Link\";import LockOutlinedIcon from\"@material-ui/icons/LockOutlined\";import CheckCircleOutlineIcon from\"@material-ui/icons/CheckCircleOutline\";import CloseIcon from'@material-ui/icons/Close';import Badge from\"@material-ui/core/Badge\";import Typography from\"@material-ui/core/Typography\";import Divider from'@material-ui/core/Divider';import{makeStyles}from\"@material-ui/core/styles\";import gql from\"graphql-tag\";import{useHistory,NavLink}from\"react-router-dom\";import{useMutation,useQuery,useApolloClient}from\"@apollo/react-hooks\";import{Animated}from\"react-animated-css\";import{UserContext}from\"../userContext\";import{useScrollDisable}from\"../Hooks/useScrollDisable\";import{useWindowSize}from\"../Hooks/useWindowSize\";import ModalLayout from\"../Layouts/ModalLayout\";import Spinner from\"../Atoms/Spinner\";import Copyright from\"../Atoms/copyright\";import SocialLogins from\"../Atoms/SignIn/SocialLogins\";var LOGIN=gql(_templateObject());function SignIn(_ref){var propContext=_ref.propContext;var classes=useStyles();var history=useHistory();var _useContext=useContext(UserContext),context=_useContext.context,setContext=_useContext.setContext;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),localContext=_useState2[0],setLocalContext=_useState2[1];var _useState3=useState({email:\"ihoskovecpetr@gmail.com\",password:\"heslo\"}),_useState4=_slicedToArray(_useState3,2),input=_useState4[0],setInput=_useState4[1];var windowSize=useWindowSize();var _useMutation=useMutation(LOGIN),_useMutation2=_slicedToArray(_useMutation,2),login=_useMutation2[0],_useMutation2$=_useMutation2[1],loading=_useMutation2$.loading,error=_useMutation2$.error,data=_useMutation2$.data;var _ref2=data?data.login:{dataOut:undefined},dataOut=_ref2.dataOut;var _ref3=data?data.login:{errorOut:undefined},errorOut=_ref3.errorOut;useEffect(function(){if(localContext.success){setTimeout(function(){if(window.eventId){console.log(\"After Sign In goEvent\");history.push(\"/event/\".concat(window.eventId));}else{console.log(\"After Sign In Goback\");// history.goBack();\n}},100);}},[localContext]);useEffect(function(){if(propContext){setLocalContext(propContext);}else{setLocalContext(context);}},[context,propContext]);useEffect(function(){if(dataOut&&dataOut.success&&!localContext.name){window.localStorage.setItem(\"token\",dataOut.token);console.log(\"document.getElementById(rememberMe).checked: \",document.getElementById(\"rememberMe\").checked);setContext(function(prev){return _objectSpread({},prev,{_id:dataOut._id,success:dataOut.success,name:dataOut.name,email:dataOut.email,picture:dataOut.picture,description:dataOut.description,token:dataOut.token,rememberSignIn:document.getElementById(\"rememberMe\").checked});});}},[dataOut,localContext]);var onSignIn=function onSignIn(e){e.preventDefault();var email=document.getElementById(\"email\").value;var password=document.getElementById(\"password\").value;login({variables:{email:email,password:password}});};var handleInputChange=function handleInputChange(e){return setInput(_objectSpread({},input,_defineProperty({},e.currentTarget.name,e.currentTarget.value)));};return React.createElement(ModalLayout,null,React.createElement(Paper,{className:classes.paper,style:{marginTop:0.10*windowSize.height,maxHeight:0.88*windowSize.height,overflow:'scroll'}},React.createElement(Grid,{container:true,justify:\"flex-end\"},React.createElement(Grid,{item:true},React.createElement(CloseIcon,{onClick:function onClick(){history.goBack();}}))),dataOut&&dataOut.success&&React.createElement(Avatar,{className:classes.avatarSuccess},React.createElement(CheckCircleOutlineIcon,null)),!loading&&!dataOut&&React.createElement(Avatar,{className:classes.avatar},React.createElement(LockOutlinedIcon,null)),loading&&React.createElement(\"div\",{className:classes.spinner},React.createElement(Spinner,{height:40,width:40})),loading?React.createElement(Typography,{component:\"h1\",variant:\"h5\"},\"Loading...\"):React.createElement(React.Fragment,null,React.createElement(Typography,{component:\"h1\",variant:\"h5\",className:classes.signInLine},\"Sign in\")),React.createElement(Typography,{className:classes.signInText},\"with your social network\"),React.createElement(SocialLogins,null),React.createElement(Grid,{container:true,alignItems:\"center\",justify:\"center\"},React.createElement(Grid,{item:true,xs:5},React.createElement(\"div\",{className:classes.greyLine})),React.createElement(Grid,{item:true,xs:1},React.createElement(Grid,{container:true,justify:\"center\"},React.createElement(Grid,{item:true},\"or\"))),React.createElement(Grid,{item:true,xs:5},React.createElement(\"div\",{className:classes.greyLine}))),React.createElement(\"form\",{className:classes.form,noValidate:true},errorOut&&errorOut.map(function(item){return React.createElement(Alert,{severity:\"error\",key:item.message},item.message);}),!data&&React.createElement(TextField,{margin:\"normal\",required:true,value:input.email,fullWidth:true,onChange:handleInputChange,label:\"Email Address\",name:\"email\",id:\"email\",error:errorOut}),!dataOut||dataOut.success&&React.createElement(TextField,{margin:\"normal\",required:true,disabled:true,value:input.email,fullWidth:true,label:\"Email Address\",name:\"email\",id:\"email\",error:errorOut}),errorOut&&React.createElement(Animated,{animationIn:\"shake\",animationOut:\"fadeOut\",animationInDelay:0,animationInDuration:800,isVisible:true},React.createElement(TextField,{margin:\"normal\",required:true,value:input.email,fullWidth:true,onChange:handleInputChange,label:\"Email Address\",name:\"email\",id:\"email\",error:errorOut})),!data&&React.createElement(TextField,{margin:\"normal\",required:true,fullWidth:true,value:input.password,onChange:handleInputChange,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",error:errorOut}),dataOut&&dataOut.success&&React.createElement(TextField,{margin:\"normal\",required:true,fullWidth:true,value:input.password,onChange:handleInputChange,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",error:errorOut}),errorOut&&React.createElement(Animated,{animationIn:\"shake\",animationOut:\"fadeOut\",animationInDelay:0,animationInDuration:1000,isVisible:true},React.createElement(TextField,{margin:\"normal\",required:true,fullWidth:true,value:input.password,onChange:handleInputChange,name:\"password\",label:\"Password\",type:\"password\",id:\"password\",error:errorOut})),React.createElement(FormControlLabel,{control:React.createElement(Checkbox,{defaultChecked:true,id:\"rememberMe\",color:\"primary\"}),label:\"Remember me\"}),React.createElement(Button,{type:\"submit\",id:\"submit\",fullWidth:true,variant:\"contained\",color:\"primary\",className:classes.submit,onClick:function onClick(e){onSignIn(e);}},\"Sign In\"),React.createElement(Grid,{container:true},React.createElement(Grid,{item:true,xs:true},React.createElement(Link,{variant:\"body2\"},\"Forgot password?\")),React.createElement(Grid,{item:true},React.createElement(Badge,{color:\"secondary\",badgeContent:React.createElement(\"p\",{style:{margin:0}},React.createElement(\"b\",null,\"HERE\")),anchorOrigin:{vertical:\"bottom\",horizontal:\"left\"}},React.createElement(Link,{href:\"/signup\",className:classes.linkClass},\"Sign Up here!\"))))),React.createElement(Box,{mt:8},React.createElement(Copyright,null))));}var useStyles=makeStyles(function(theme){return{\"@global\":{body:{backgroundColor:theme.palette.common.white}},paper:{// marginTop: theme.spacing(10),\npadding:theme.spacing(3,2),width:'100%',display:\"flex\",flexDirection:\"column\",alignItems:\"center\"},avatar:{backgroundColor:theme.palette.charliePink},avatarSuccess:{backgroundColor:\"green\"},spinner:{},signInLine:{margin:5},signInText:{margin:5,fontSize:'0.8rem',fontWeight:500,color:'grey'},form:{width:\"100%\",// Fix IE 11 issue.\nmarginTop:theme.spacing(1)},submit:{margin:theme.spacing(3,0,2)},greyLine:{height:2,width:'100%',backgroundColor:\"lightGrey\"},blueUnderline:{margin:20,color:\"blue\",\"&:hover\":{textDecoration:\"underline\"}},linkClass:{paddingBottom:10}};});export default SignIn;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/SignIn.js"],"names":["React","useState","useEffect","useContext","Grid","Box","Paper","Avatar","Alert","Button","TextField","FormControlLabel","Checkbox","Link","LockOutlinedIcon","CheckCircleOutlineIcon","CloseIcon","Badge","Typography","Divider","makeStyles","gql","useHistory","NavLink","useMutation","useQuery","useApolloClient","Animated","UserContext","useScrollDisable","useWindowSize","ModalLayout","Spinner","Copyright","SocialLogins","LOGIN","SignIn","propContext","classes","useStyles","history","context","setContext","localContext","setLocalContext","email","password","input","setInput","windowSize","login","loading","error","data","dataOut","undefined","errorOut","success","setTimeout","window","eventId","console","log","push","name","localStorage","setItem","token","document","getElementById","checked","prev","_id","picture","description","rememberSignIn","onSignIn","e","preventDefault","value","variables","handleInputChange","currentTarget","paper","marginTop","height","maxHeight","overflow","goBack","avatarSuccess","avatar","spinner","signInLine","signInText","greyLine","form","map","item","message","submit","margin","vertical","horizontal","linkClass","theme","body","backgroundColor","palette","common","white","padding","spacing","width","display","flexDirection","alignItems","charliePink","fontSize","fontWeight","color","blueUnderline","textDecoration","paddingBottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Box from \"@material-ui/core/Box\";\nimport Paper from \"@material-ui/core/Paper\";\n\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport Button from \"@material-ui/core/Button\";\nimport TextField from \"@material-ui/core/TextField\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Link from \"@material-ui/core/Link\";\nimport LockOutlinedIcon from \"@material-ui/icons/LockOutlined\";\nimport CheckCircleOutlineIcon from \"@material-ui/icons/CheckCircleOutline\";\nimport CloseIcon from '@material-ui/icons/Close';\nimport Badge from \"@material-ui/core/Badge\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Divider from '@material-ui/core/Divider';\nimport { makeStyles } from \"@material-ui/core/styles\";\n\nimport gql from \"graphql-tag\";\nimport { useHistory, NavLink } from \"react-router-dom\";\nimport { useMutation, useQuery, useApolloClient } from \"@apollo/react-hooks\";\nimport { Animated } from \"react-animated-css\";\n\nimport { UserContext } from \"../userContext\";\nimport { useScrollDisable } from \"../Hooks/useScrollDisable\";\nimport { useWindowSize } from \"../Hooks/useWindowSize\";\n\nimport ModalLayout from \"../Layouts/ModalLayout\";\nimport Spinner from \"../Atoms/Spinner\";\nimport Copyright from \"../Atoms/copyright\";\nimport SocialLogins from \"../Atoms/SignIn/SocialLogins\";\n\nconst LOGIN = gql`\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      dataOut {\n        _id\n        success\n        name\n        email\n        picture\n        description\n        token\n      }\n      errorOut {\n        name\n        message\n      }\n    }\n  }\n`;\n\nfunction SignIn({propContext}) {\n  const classes = useStyles();\n  let history = useHistory();\n\n  const { context, setContext } = useContext(UserContext);\n  const [localContext, setLocalContext] = useState({});\n  const [input, setInput] = useState({email: \"ihoskovecpetr@gmail.com\", password: \"heslo\"});\n  const windowSize = useWindowSize();\n\n  const [login, { loading, error, data }] = useMutation(LOGIN);\n  \n  const { dataOut } = data ? data.login : { dataOut: undefined };\n  const { errorOut } = data ? data.login : { errorOut: undefined };\n\n  useEffect(() => {\n\n    if (localContext.success) {\n      setTimeout(() => {\n        if(window.eventId){\n          console.log(\"After Sign In goEvent\")\n          history.push(`/event/${window.eventId}`);\n        }else{\n          console.log(\"After Sign In Goback\")\n          // history.goBack();\n        }\n      }, 100);\n    }\n\n  },[localContext])\n\n\n  useEffect(() => {\n    if(propContext){\n      setLocalContext(propContext)\n    }else{\n      setLocalContext(context)\n    }\n  },[context, propContext])\n\n  useEffect(() => {\n\n    if (dataOut && dataOut.success && !localContext.name) {\n      window.localStorage.setItem(\"token\", dataOut.token);\n      console.log(\"document.getElementById(rememberMe).checked: \", document.getElementById(\"rememberMe\").checked)\n      setContext(prev => { return {\n        ...prev,\n        _id: dataOut._id,\n        success: dataOut.success,\n        name: dataOut.name,\n        email: dataOut.email,\n        picture: dataOut.picture,\n        description: dataOut.description,\n        token: dataOut.token,\n        rememberSignIn: document.getElementById(\"rememberMe\").checked,\n      }});\n    }\n  },[dataOut, localContext])\n\n\n  const onSignIn = (e) => {\n    e.preventDefault();\n    let email = document.getElementById(\"email\").value;\n    let password = document.getElementById(\"password\").value;\n    login({\n      variables: {\n        email: email,\n        password: password,\n      }\n    });\n  }\n\n  const handleInputChange = (e) => setInput({\n    ...input,\n    [e.currentTarget.name]: e.currentTarget.value\n  })\n\n  return (\n    <ModalLayout>\n      <Paper \n        className={classes.paper}\n        style={{\n          marginTop: 0.10 * windowSize.height,\n          maxHeight: 0.88 * windowSize.height,\n          overflow: 'scroll'\n        }}>\n          <Grid container justify='flex-end'>\n            <Grid item>\n              <CloseIcon onClick={() => {history.goBack()}} />\n            </Grid>\n          </Grid>\n        {dataOut && dataOut.success && (\n          <Avatar className={classes.avatarSuccess}>\n            <CheckCircleOutlineIcon />\n          </Avatar>\n        )}\n        {!loading && !dataOut && (\n          <Avatar className={classes.avatar}>\n            <LockOutlinedIcon />\n          </Avatar>\n        )}\n        {loading && (\n          <div className={classes.spinner}>\n            <Spinner height={40} width={40} />\n          </div>\n        )}\n        {loading ? <Typography component=\"h1\" variant=\"h5\">\n          Loading...\n        </Typography>\n        : <>\n        <Typography component=\"h1\" variant=\"h5\" className={classes.signInLine} >\n          Sign in\n        </Typography> \n        </>}\n        <Typography className={classes.signInText}>\n          with your social network\n        </Typography>\n\n        <SocialLogins />\n\n        <Grid container alignItems='center' justify='center'>\n          <Grid item xs={5}>\n            <div className={classes.greyLine} ></div>\n          </Grid>\n          <Grid item xs={1}>\n            <Grid container justify='center'>\n              <Grid item>\n                or\n              </Grid>\n            </Grid>\n          </Grid>\n          <Grid item xs={5}>\n            <div className={classes.greyLine} ></div>\n          </Grid>\n          </Grid>\n\n        <form className={classes.form} noValidate>\n          {errorOut &&\n            errorOut.map(item => (\n              <Alert severity=\"error\" key={item.message}>\n                {item.message}\n              </Alert>\n            ))}\n\n\n          {!data && \n                <TextField\n                margin=\"normal\"\n                required\n                value={input.email}\n                fullWidth\n                onChange={handleInputChange}\n                label=\"Email Address\"\n                name=\"email\"\n                id=\"email\"\n                error={errorOut}\n              />\n           }\n          {!dataOut || dataOut.success && (\n                  <TextField\n                  margin=\"normal\"\n                  required\n                  disabled={true}\n                  value={input.email}\n                  fullWidth\n                  label=\"Email Address\"\n                  name=\"email\"\n                  id=\"email\"\n                  error={errorOut}\n                />\n          )}\n          {errorOut && (\n            <Animated\n              animationIn=\"shake\"\n              animationOut=\"fadeOut\"\n              animationInDelay={0}\n              animationInDuration={800}\n              isVisible={true}\n            >\n              <TextField\n                margin=\"normal\"\n                required\n                value={input.email}\n                fullWidth\n                onChange={handleInputChange}\n                label=\"Email Address\"\n                name=\"email\"\n                id=\"email\"\n                error={errorOut}\n              />\n            </Animated>\n          )}\n\n          {!data && <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                value={input.password}\n                onChange={handleInputChange}\n                name=\"password\"\n                label=\"Password\"\n                type=\"password\"\n                id=\"password\"\n                error={errorOut}\n              />}\n          {dataOut && dataOut.success && <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                value={input.password}\n                onChange={handleInputChange}\n                name=\"password\"\n                label=\"Password\"\n                type=\"password\"\n                id=\"password\"\n                error={errorOut}\n              />}\n          {errorOut && (\n            <Animated\n              animationIn=\"shake\"\n              animationOut=\"fadeOut\"\n              animationInDelay={0}\n              animationInDuration={1000}\n              isVisible={true}\n            >\n              <TextField\n                margin=\"normal\"\n                required\n                fullWidth\n                value={input.password}\n                onChange={handleInputChange}\n                name=\"password\"\n                label=\"Password\"\n                type=\"password\"\n                id=\"password\"\n                error={errorOut}\n              />\n            </Animated>\n          )}\n\n          <FormControlLabel\n            control={<Checkbox defaultChecked id=\"rememberMe\" color=\"primary\" />}\n            label=\"Remember me\"\n          />\n          <Button\n            type=\"submit\"\n            id=\"submit\"\n            fullWidth\n            variant=\"contained\"\n            color=\"primary\"\n            className={classes.submit}\n            onClick={e => {\n              onSignIn(e)\n            }}\n          >\n            Sign In\n          </Button>\n          <Grid container>\n            <Grid item xs>\n              <Link variant=\"body2\">\n                Forgot password?\n              </Link>\n            </Grid>\n            <Grid item>\n              <Badge\n                color=\"secondary\"\n                badgeContent={\n                  <p style={{ margin: 0 }}>\n                    <b>HERE</b>\n                  </p>\n                }\n                anchorOrigin={{\n                  vertical: \"bottom\",\n                  horizontal: \"left\"\n                }}\n              >\n                <Link href=\"/signup\" className={classes.linkClass}>\n                  Sign Up here!\n                </Link>\n              </Badge>\n            </Grid>\n          </Grid>\n        </form>\n        <Box mt={8}>\n          <Copyright />\n        </Box>\n      </Paper>\n    </ModalLayout>\n  );\n}\n\nconst useStyles = makeStyles(theme => ({\n  \"@global\": {\n    body: {\n      backgroundColor: theme.palette.common.white\n    }\n  },\n  paper: {\n    // marginTop: theme.spacing(10),\n    padding: theme.spacing(3, 2),\n    width: '100%',\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  },\n  avatar: {\n    backgroundColor: theme.palette.charliePink\n  },\n  avatarSuccess: {\n    backgroundColor: \"green\"\n  },\n  spinner: {\n  },\n  signInLine:{\n    margin: 5\n  },\n  signInText: {\n    margin: 5,\n    fontSize: '0.8rem',\n    fontWeight: 500,\n    color: 'grey'\n  },\n  form: {\n    width: \"100%\", // Fix IE 11 issue.\n    marginTop: theme.spacing(1)\n  },\n  submit: {\n    margin: theme.spacing(3, 0, 2)\n  },\n  greyLine: {\n    height: 2,\n    width: '100%',\n    backgroundColor: \"lightGrey\"\n  },\n  blueUnderline: {\n    margin: 20,\n    color: \"blue\",\n    \"&:hover\": {\n      textDecoration: \"underline\"\n    }\n  },\n  linkClass: {\n    paddingBottom: 10\n  }\n}));\n\nexport default SignIn;\n"]},"metadata":{},"sourceType":"module"}