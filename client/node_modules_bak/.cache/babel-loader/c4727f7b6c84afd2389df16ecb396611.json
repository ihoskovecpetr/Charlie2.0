{"ast":null,"code":"import _toConsumableArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/petrhoskovec/Desktop/code/Charlie2.0/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useState,useContext,useEffect}from\"react\";import Container from\"@material-ui/core/Container\";import Grid from\"@material-ui/core/Grid\";import AppBar from\"@material-ui/core/AppBar\";import Tabs from\"@material-ui/core/Tabs\";import Tab from\"@material-ui/core/Tab\";import Badge from\"@material-ui/core/Badge\";import Box from\"@material-ui/core/Box\";import Typography from\"@material-ui/core/Typography\";import{makeStyles,useTheme}from\"@material-ui/core/styles\";import SwipeableViews from\"react-swipeable-views\";import{useMutation,useQuery}from\"@apollo/react-hooks\";import gql from\"graphql-tag\";import{UserContext}from\"../userContext\";import{sortByDate}from\"../Services/functions\";import{useXsSize}from\"../Hooks/useXsSize\";import{PROFILE_DATA}from\"src/Services/GQL/PROFILE_DATA\";import Copyright from\"../Atoms/copyright\";import Spinner from\"../Atoms/Spinner\";import RatingCardNew from\"../Atoms/Profile/RatingCardNew\";import ProfileTopBox from\"../Molecules/profile/ProfileTopBox\";import ProfileBookingsPrinter from\"src/Molecules/profile/ProfileBookingsPrinter\";import ProfileEventsPrinter from\"src/Molecules/profile/ProfileEventsPrinter\";function TabPanel(props){var children=props.children,value=props.value,index=props.index,other=_objectWithoutProperties(props,[\"children\",\"value\",\"index\"]);return React.createElement(Typography,Object.assign({component:\"div\",role:\"tabpanel\",hidden:value!==index,id:\"full-width-tabpanel-\".concat(index),\"aria-labelledby\":\"full-width-tab-\".concat(index)},other),value===index&&React.createElement(Box,{p:3},children));}function a11yProps(index){return{id:\"full-width-tab-\".concat(index),\"aria-controls\":\"full-width-tabpanel-\".concat(index)};}function Profile(){var classes=useStyles();var theme=useTheme();var _useContext=useContext(UserContext),context=_useContext.context,setContext=_useContext.setContext;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),value=_useState2[0],setValue=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),bookingsArray=_useState4[0],setBookingsArray=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),countUnseenBookings=_useState6[0],setCountUnseenBookings=_useState6[1];var _useXsSize=useXsSize(),xs_size_memo=_useXsSize.xs_size_memo,md_size_memo=_useXsSize.md_size_memo;var _useQuery=useQuery(PROFILE_DATA,{variables:{host_id:context._id},fetchPolicy:\"network-only\"}),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data;// const hostingStates = useQuery(USER_EVENTS, {\n//   variables: { user_id: user._id }\n// });\n// const bookingStates = useQuery(USER_BOOKING, {\n//   variables: { user_id: user._id }\n// });\nuseEffect(function(){document.documentElement.style.overflow=\"auto\";// window.scrollTo(0, 0);\nreturn function(){};},[]);var trsfmFeed=function trsfmFeed(events,type){return events.map(function(item){return _objectSpread({},item,{type:type});});};useEffect(function(){if(data){var showUserBookings=data.showUserBookings,showHostBookings=data.showHostBookings;var transformedBookingsArr=[].concat(_toConsumableArray(trsfmFeed(showUserBookings,\"yourBooking\")),_toConsumableArray(trsfmFeed(showHostBookings,\"askForJoin\")));var sortedFeed=sortByDate(transformedBookingsArr,\"createdAt\",\"DESC\");setBookingsArray(sortedFeed);}},[data]);var handleChange=function handleChange(event,newValue){setValue(newValue);};var handleChangeIndex=function handleChangeIndex(index){setValue(index);};return React.createElement(\"div\",{className:classes.profileWrap,id:\"profile_wrap\",style:{overflow:\"hidden\",color:md_size_memo?\"white\":\"black\",background:md_size_memo?\"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(104,81,123,1) 100%)\":null}},React.createElement(Container,{maxWidth:\"md\",style:{padding:0,paddingTop:md_size_memo?0:80},className:classes.profileContainer},React.createElement(Grid,{container:true,justify:\"center\",spacing:2},React.createElement(Grid,{item:true,md:4,xs:12},React.createElement(ProfileTopBox,{errorQuery:error,showRatings:data&&data.showRatings})),React.createElement(Grid,{item:true,md:8,xs:12},React.createElement(AppBar,{position:\"static\",color:\"primary\",className:classes.appBar,classes:{colorPrimary:classes.colorPrimary}},React.createElement(Tabs,{value:value,onChange:handleChange,indicatorColor:\"primary\",textColor:\"primary\",variant:\"fullWidth\",\"aria-label\":\"full width tabs example\"},React.createElement(Tab,Object.assign({label:React.createElement(Badge,{color:\"secondary\",badgeContent:context.countUnseenBookings},\"BOOKINGS\")},a11yProps(1))),React.createElement(Tab,Object.assign({label:React.createElement(Badge,{color:\"primary\",badgeContent:data&&data.showUserBookings&&data.showUserBookings.length+data.userEvents.length},\"EVENTS\")},a11yProps(2))),React.createElement(Tab,Object.assign({label:React.createElement(Badge,{color:\"secondary\",badgeContent:context.countUnseenRatings},\"RATINGS\")},a11yProps(3))))),React.createElement(SwipeableViews,{axis:theme.direction===\"rtl\"?\"x-reverse\":\"x\",index:value,onChangeIndex:handleChangeIndex,style:{width:\"100%\",padding:0}},React.createElement(TabPanel,{value:value,index:0,dir:theme.direction,style:{padding:0}},loading&&React.createElement(Grid,{container:true,justify:\"center\"},React.createElement(Grid,{item:true},React.createElement(Spinner,{height:100,width:100}))),bookingsArray&&bookingsArray.map(function(booking,index){return React.createElement(Grid,{container:true,justify:\"center\",alignItems:\"center\",alignContent:\"center\",style:{width:\"100%\",padding:0}},React.createElement(Grid,{item:true,xs:12,key:index},React.createElement(ProfileBookingsPrinter,{booking:booking})));})),React.createElement(TabPanel,{value:value,index:1,dir:theme.direction,className:classes.tabPanel},loading&&React.createElement(Spinner,null),data&&React.createElement(ProfileEventsPrinter,{showUserBookings:data.showUserBookings,userEvents:data.userEvents})),React.createElement(TabPanel,{value:value,index:2,dir:theme.direction,className:classes.tabPanel,style:{width:\"100%\"}},loading&&React.createElement(Spinner,{height:100,width:100}),data&&data.showRatings&&data.showRatings.map(function(rating,index){return React.createElement(React.Fragment,null,React.createElement(RatingCardNew,{rating:rating,key:index}));}))))),React.createElement(Box,{mt:8},React.createElement(Copyright,null))));}var useStyles=makeStyles(function(theme){return{profileWrap:{top:0,width:\"100%\",minHeight:\"100vh\",position:\"absolute\",background:\"#F2F2F2\"// background:\n//   \"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(103,80,122,1) 100%)\"\n},profileContainer:{top:0},appBar:{zIndex:1,color:\"white !important\",backgroundColor:\"transparent\",boxShadow:\"none\"},tabPanel:{minHeight:\"100vh\",width:\"100%\"},colorPrimary:{color:\"white !important\",backgroundColor:\"transparent\"}};});export default Profile;","map":{"version":3,"sources":["/Users/petrhoskovec/Desktop/code/Charlie2.0/client/src/Pages/Profile.js"],"names":["React","useState","useContext","useEffect","Container","Grid","AppBar","Tabs","Tab","Badge","Box","Typography","makeStyles","useTheme","SwipeableViews","useMutation","useQuery","gql","UserContext","sortByDate","useXsSize","PROFILE_DATA","Copyright","Spinner","RatingCardNew","ProfileTopBox","ProfileBookingsPrinter","ProfileEventsPrinter","TabPanel","props","children","value","index","other","a11yProps","id","Profile","classes","useStyles","theme","context","setContext","setValue","bookingsArray","setBookingsArray","countUnseenBookings","setCountUnseenBookings","xs_size_memo","md_size_memo","variables","host_id","_id","fetchPolicy","loading","error","data","document","documentElement","style","overflow","trsfmFeed","events","type","map","item","showUserBookings","showHostBookings","transformedBookingsArr","sortedFeed","handleChange","event","newValue","handleChangeIndex","profileWrap","color","background","padding","paddingTop","profileContainer","showRatings","appBar","colorPrimary","length","userEvents","countUnseenRatings","direction","width","booking","tabPanel","rating","top","minHeight","position","zIndex","backgroundColor","boxShadow"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport Container from \"@material-ui/core/Container\";\nimport Grid from \"@material-ui/core/Grid\";\nimport AppBar from \"@material-ui/core/AppBar\";\nimport Tabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport Badge from \"@material-ui/core/Badge\";\nimport Box from \"@material-ui/core/Box\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\n\nimport SwipeableViews from \"react-swipeable-views\";\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\nimport gql from \"graphql-tag\";\n\nimport { UserContext } from \"../userContext\";\nimport { sortByDate } from \"../Services/functions\";\nimport { useXsSize } from \"../Hooks/useXsSize\";\nimport { PROFILE_DATA } from \"src/Services/GQL/PROFILE_DATA\";\n\nimport Copyright from \"../Atoms/copyright\";\nimport Spinner from \"../Atoms/Spinner\";\nimport RatingCardNew from \"../Atoms/Profile/RatingCardNew\";\nimport ProfileTopBox from \"../Molecules/profile/ProfileTopBox\";\nimport ProfileBookingsPrinter from \"src/Molecules/profile/ProfileBookingsPrinter\"\nimport ProfileEventsPrinter from \"src/Molecules/profile/ProfileEventsPrinter\";\n\nfunction TabPanel(props) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <Typography\n      component=\"div\"\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`full-width-tabpanel-${index}`}\n      aria-labelledby={`full-width-tab-${index}`}\n      {...other}\n    >\n      {value === index && <Box p={3}>{children}</Box>}\n    </Typography>\n  );\n}\n\nTabPanel.propTypes = {\n  children: PropTypes.node,\n  index: PropTypes.any.isRequired,\n  value: PropTypes.any.isRequired\n};\n\nfunction a11yProps(index) {\n  return {\n    id: `full-width-tab-${index}`,\n    \"aria-controls\": `full-width-tabpanel-${index}`\n  };\n}\n\nfunction Profile() {\n  const classes = useStyles();\n  const theme = useTheme();\n  const { context, setContext } = useContext(UserContext);\n  const [value, setValue] = useState(0);\n  const [bookingsArray, setBookingsArray] = useState([]);\n  const [countUnseenBookings, setCountUnseenBookings] = useState(0);\n  const { xs_size_memo, md_size_memo } = useXsSize();\n  const { loading, error, data } = useQuery(PROFILE_DATA, {\n    variables: { host_id: context._id },\n    fetchPolicy: \"network-only\"\n  });\n  // const hostingStates = useQuery(USER_EVENTS, {\n  //   variables: { user_id: user._id }\n  // });\n  // const bookingStates = useQuery(USER_BOOKING, {\n  //   variables: { user_id: user._id }\n  // });\n  useEffect(() => {\n    document.documentElement.style.overflow = \"auto\";\n    // window.scrollTo(0, 0);\n    return () => {};\n  }, []);\n\n  const trsfmFeed = (events, type) => {\n    return events.map(item => ({ ...item, type: type }));\n  };\n\n  useEffect(() => {\n\n    if (data) {\n      let {\n        showUserBookings,\n        showHostBookings\n      } = data;\n\n      const transformedBookingsArr = [\n        ...trsfmFeed(showUserBookings, \"yourBooking\"),\n        ...trsfmFeed(showHostBookings, \"askForJoin\")\n      ];\n\n      const sortedFeed = sortByDate(transformedBookingsArr, \"createdAt\", \"DESC\");\n\n      setBookingsArray(sortedFeed);\n\n    }\n  }, [data]);\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  const handleChangeIndex = index => {\n    setValue(index);\n  };\n\n  return (\n    <div\n      className={classes.profileWrap}\n      id=\"profile_wrap\"\n      style={{\n        overflow: \"hidden\",\n        color: md_size_memo ? \"white\" : \"black\",\n        background: md_size_memo\n          ? \"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(104,81,123,1) 100%)\"\n          : null\n      }}\n    >\n      <Container\n        maxWidth=\"md\"\n        style={{ padding: 0, paddingTop: md_size_memo ? 0 : 80 }}\n        className={classes.profileContainer}\n      >\n        <Grid container justify=\"center\" spacing={2}>\n          <Grid item md={4} xs={12}>\n            <ProfileTopBox errorQuery={error} showRatings={data && data.showRatings} />\n          </Grid>\n          <Grid item md={8} xs={12}>\n            <AppBar\n              position=\"static\"\n              color=\"primary\"\n              className={classes.appBar}\n              classes={{\n                colorPrimary: classes.colorPrimary\n              }}\n            >\n              <Tabs\n                value={value}\n                onChange={handleChange}\n                indicatorColor=\"primary\"\n                textColor=\"primary\"\n                variant=\"fullWidth\"\n                aria-label=\"full width tabs example\"\n              >\n                <Tab\n                  label={\n                    <Badge\n                      color=\"secondary\"\n                      badgeContent={context.countUnseenBookings}\n                    >\n                      BOOKINGS\n                    </Badge>\n                  }\n                  {...a11yProps(1)}\n                />\n                <Tab\n                  label={\n                    <Badge\n                      color=\"primary\"\n                      badgeContent={                       \n                        data &&\n                        data.showUserBookings &&\n                        data.showUserBookings.length + data.userEvents.length\n                      }\n                    >\n                      EVENTS\n                    </Badge>\n                  }\n                  {...a11yProps(2)}\n                />\n\n                <Tab\n                  label={\n                    <Badge\n                      color=\"secondary\"\n                      badgeContent={context.countUnseenRatings}\n                    >\n                      RATINGS\n                    </Badge>\n                  }\n                  {...a11yProps(3)}\n                />\n              </Tabs>\n            </AppBar>\n            <SwipeableViews\n              axis={theme.direction === \"rtl\" ? \"x-reverse\" : \"x\"}\n              index={value}\n              onChangeIndex={handleChangeIndex}\n              style={{ width: \"100%\", padding: 0 }}\n            >\n              {/* TAB PANEL 1 */}\n              <TabPanel\n                value={value}\n                index={0}\n                dir={theme.direction}\n                style={{ padding: 0 }}\n              >\n                    {loading && (\n                      <Grid container justify=\"center\">\n                        <Grid item>\n                          <Spinner height={100} width={100} />\n                        </Grid>\n                      </Grid>\n                    )}\n                  {bookingsArray && bookingsArray.map((booking, index) => (\n                    <Grid\n                      container\n                      justify=\"center\"\n                      alignItems=\"center\"\n                      alignContent=\"center\"\n                      style={{ width: \"100%\", padding: 0 }}>\n                          <Grid item xs={12} key={index}>\n                            <ProfileBookingsPrinter\n                              booking={booking}\n                            />\n                          </Grid>\n                      </Grid>\n                  ))}\n              </TabPanel>\n              {/* TAB PANEL 2 */}\n              <TabPanel \n                  value={value} \n                  index={1} \n                  dir={theme.direction}\n                  className={classes.tabPanel}>\n                    {loading && <Spinner />}\n                    {data && <ProfileEventsPrinter \n                                  showUserBookings={data.showUserBookings} \n                                  userEvents={data.userEvents} />}\n              </TabPanel>\n              {/* TAB PANEL 3 */}\n              <TabPanel\n                value={value}\n                index={2}\n                dir={theme.direction}\n                className={classes.tabPanel}\n                style={{ width: \"100%\" }}\n              >\n                {loading && <Spinner height={100} width={100} />}\n                {data &&\n                  data.showRatings &&\n                  data.showRatings.map((rating, index) => (\n                    <>\n                      <RatingCardNew rating={rating} key={index} />\n                    </>\n                  ))}\n              </TabPanel>\n            </SwipeableViews>\n          </Grid>\n        </Grid>\n\n        <Box mt={8}>\n          <Copyright />\n        </Box>\n      </Container>\n    </div>\n  );\n}\nconst useStyles = makeStyles(theme => ({\n  profileWrap: {\n    top: 0,\n    width: \"100%\",\n    minHeight: \"100vh\",\n    position: \"absolute\",\n    background: \"#F2F2F2\"\n    // background:\n    //   \"linear-gradient(90deg, rgba(29,47,94,1) 0%, rgba(103,80,122,1) 100%)\"\n  },\n  profileContainer: {\n    top: 0\n  },\n\n  appBar: {\n    zIndex: 1,\n    color: \"white !important\",\n    backgroundColor: \"transparent\",\n    boxShadow: \"none\"\n  },\n  tabPanel:{\n    minHeight: \"100vh\",\n    width: \"100%\"\n  },\n  colorPrimary: {\n    color: \"white !important\",\n    backgroundColor: \"transparent\"\n  }\n}));\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}